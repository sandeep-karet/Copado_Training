<!-- 
    Conga Approvals
    MyApprovals
    
    @2012-2023 Conga Inc. All rights reserved.

-->
<apex:page id="idMyApprovalsPage"
           controller="Apttus_Approval.MyApprovalsController"
           showHeader="false"
           sidebar="false"
           title="{!$Label.Apttus_Approval__MyApprovals}"
           action="{!doLoadApprovals}"
           lightningStylesheets="true">
        
    <html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" lang="en">
    <head>
        <apex:slds />
    </head>
    <body>

    <script type="text/javascript">
        // Theme3—Salesforce Classic 2010 user interface theme
        // Theme4d—Modern “Lightning Experience” Salesforce theme
        // Theme4u-Lightning Console theme
        // Theme4t—Salesforce mobile app theme
        var inClassicMode = "{!$User.UIThemeDisplayed == 'Theme3'}";
        var inLightningMode = "{!$User.UIThemeDisplayed == 'Theme4d' || $User.UIThemeDisplayed == 'Theme4u'}";
        var inSf1Mode = "{!$User.UIThemeDisplayed == 'Theme4t'}";
    </script>

    <script type="text/javascript" src="/soap/ajax/55.0/connection.js"></script>
    <script type="text/javascript" src="/soap/ajax/55.0/apex.js"></script>

    <apex:include pageName="Apttus_Approval__ApprovalsJSLibInclude" />

    <apex:includescript value="{!URLFOR($Resource.Apttus_Approval__JQuery22, 'jquery-2.2.2.js')}" />
    <apex:includescript value="{!URLFOR($Resource.Apttus_Approval__JQuery22, 'JQuery22/jquery-migrate-1.4.1.min.js')}" />
    <apex:includescript value="{!URLFOR($Resource.Apttus_Approval__JQueryUI112, 'jquery-ui-1.12.1.js')}" />
    <apex:stylesheet value="{!URLFOR($Resource.Apttus_Approval__JQueryUI112, 'jquery-ui-1.12.1.css')}" />

    <apex:stylesheet value="{!URLFOR($Resource.Apttus_Approval__ApprovalsPageResources, 'CPQDelight.css')}" />
    <apex:stylesheet value="{!URLFOR($Resource.Apttus_Approval__ApprovalsPageResources, 'ApprovalsPageStyles.css')}" />
    <apex:stylesheet value="{!URLFOR($Resource.Apttus_Approval__JQueryDataTables110, 'css/jquery.dataTables.css')}" />
    <apex:includescript value="{!URLFOR($Resource.Apttus_Approval__JQueryDataTables110, 'js/jquery.dataTables.min.js')}" />

    <style>
        /* hide the close box on the dialog */
        .no-close .ui-dialog-titlebar-close {
            display: none !important;
        }
        body.vf-body, body.sfdcBody, .slds-scope.vf-body, .slds-scope.sfdcBody {
            padding: 0 0 0 0 !important;
        }
        .apexp .bPageBlock.apexDefaultPageBlock .pbBody {
            margin-top: 0px !important;
            overflow-wrap: anywhere;
        }
        .displayFieldPanel {
            overflow-wrap: anywhere;
        }
        /*.search_field {
            display: inline-block;
            width: 100%;
        }
        .search_field input {
            padding: 2px;
        }
        #search-text-input {
            border-top:thin solid  #e5e5e5;
            border-right:thin solid #e5e5e5;
            border-bottom:0;
            border-left:thin solid  #e5e5e5;
            box-shadow:0px 1px 1px 1px #e5e5e5;
            float:left;
            height:17px;
            margin:.8em 0 0 .5em;
            outline:0;
            padding:.4em 0 .4em .6em;
            width:183px;
        }
        .search_field button {
            border: none;
            background: none;
            float: right;
            margin: 0px !important;
        }*/
        /*.rich-toolbar {
            background-color: transparent !important;
            background-image: none !important;
            border: none !important;
        }
        .rich-toolbar-item {
            background-color: transparent !important;
            background-image: none !important;
            border: none !important;
        }
        .rich-tab-active-lightning {
            background-image: none !important;
            background-color: transparent !important;
            font-family: "Salesforce Sans",Arial,sans-serif !important;
            font-size: 100% !important;
        }
        .rich-tab-inactive-lightning {
            background-image: none !important;
            background-color: transparent !important;
            font-family: "Salesforce Sans",Arial,sans-serif !important;
            font-size: 100% !important;
        }
        .rich-tabpanel-content-lightning {
            background-color: transparent !important;
            border-left-width: 0 !important;
            border-right-width: 0 !important;

            border-top-width: 0px !important;
            border-top-style: none !important;
        }
        .rich-tabhdr-lightning {
            background-image: none !important;
            background-color: transparent !important;
            border-top-width: 0px !important;
            border-top-style: none !important;
        }*/
        /* remove tab side borders in lightning but affects classic mode as well */
        /*.rich-tabhdr-side-border {
            background-image: none !important;
            background-color: transparent !important;
        }
        .rich-tabhdr-side-cell {
            border-top-width: 0px !important;
            border-top-style: none !important;
        }*/ 
    </style>
    
    <script type="text/javascript">

        // make sure jQuery doesn't conflict with any other JS libraries
        var j$ = jQuery.noConflict();
        
        // setup namespace
        j$.APTTUS = {};
        
        // define common dialog form fields
        var fldRequestId;
        var fldAssigneeType;
        var fldAssigneeName;
        var fldAssigneeId;
        var fldComment;

        // define add approver dialog form fields
        var fldMode;
        var fldStepLabel;
        var errorTips;
        var uiFormFields;

        // define search approver dialog datatable objects
        var userTable = null;
        var queueTable = null;
        var roleTable = null;
        
        // hilight table rows
        var lastRow;
        function hilightRow(elem) {
            if (lastRow != undefined) {
                lastRow.style.backgroundColor = 'white';
            }
            
            elem.style.backgroundColor = '#fecf70';
            lastRow = elem;
        }
        
        /**
         * Initializes the call
         */
        function initCall() {
        
            try {
                sforce.connection.sessionId = "{!$Api.Session_ID}"; //to avoid session timeout
            } catch(e) {
                ap_erroralert(ap_cERROR_UNKNOWN,e);
            }
        
        }

        /**
         * Show spinner
         */
        function showSpinner() {
            
            j$("#idSpinnerPanel").show();
            return false;
            
        }

        /**
         * Hide spinner
         */
        function hideSpinner() {

            j$("#idSpinnerPanel").hide();
            return true;
        
        }

        // initialize after the document has loaded
        j$(document).ready(function() {

        });

        // ================================================================================
        // ADD APPROVER
        // ================================================================================

        /**
         * Show add approver dialog
         * @param requestId the ID of the approval request context object
         */
        function showAddApprover(requestId) {
            
            // store the request id in the global namespace
            j$.APTTUS.RequestId = requestId;

            // save the request id on the form
            j$("[id*=idAddApproverRequestId]").val(requestId);
            
            // show spinner
            showSpinner();

            // let the controller know we are showing the add approver dialog
            invokeShowAddApprover(requestId);

            return false;
            
        }
        
        /**
         * Callback when the show is completed
         */
        function onShowAddApproverComplete() {
        
            // hide spinner
            hideSpinner();
            
            // show add approver dialog
            showAddApproverDialog();

            return true;

        }
    
        /**
         * Show add approver dialog
         */
        function showAddApproverDialog() {

            // show the dialog
            j$("#idAddApproverDialogSection").addClass("slds-fade-in-open");
            j$("#idAddApproverDialogBackdrop").addClass("slds-backdrop_open");
            j$("#idAddApproverPanel").show();

        }

        /**
         * Hide add approver dialog
         */
        function hideAddApproverDialog() {

            // hide the dialog
            j$("#idAddApproverDialogSection").removeClass("slds-fade-in-open");
            j$("#idAddApproverDialogBackdrop").removeClass("slds-backdrop_open");
            j$("#idAddApproverPanel").hide();

        }

        /**
         * Close add approver dialog
         */
        function closeAddApprover() {

            // close the dialog
            hideAddApproverDialog();
            
            // clear global namespace parameters
            j$.APTTUS.RequestId = '';
            j$.APTTUS.AssigneeType = '';
            j$.APTTUS.AssigneeName = '';
            j$.APTTUS.AssigneeId = '';
        
            // clear and reset form fields
            j$("[id*=idAddApproverMode]").val('');
            j$("[id*=idAddApproverStepLabel]").val('');
            j$("[id*=idAddApproverAssigneeType]").val('');
            j$("[id*=idAddApproverAssigneeName]").val('');
            j$("[id*=idAddApproverAssigneeId]").val('');
            j$("[id*=idAddApproverComment]").val('');
            
            // clear error fields
            if (typeof errorTips != "undefined") {
                errorTips.removeClass("slds-has-error");
                errorTips.text("Specify information about the approver you are adding for the selected request");

            }
            if (typeof uiFormFields != "undefined") {
                uiFormFields.removeClass("slds-has-error");
                
            }

        }

        function addError(t) {
            errorTips
                .text(t)
                .addClass("slds-has-error");
        }
    
        function checkLength(o, n, min, max) {
            if (o.val().length > max || o.val().length < min) {
                o.addClass("slds-has-error");
                //addError("Length of " + n + " must be between " + min + " and " + max + ".");
                return false;
                
            } else {
                return true;
            }
        }

        /**
         * Validate add approver form fields
         */
        function validateAddApprover() {

            // get form field values from the dialog
            var modeElem = j$("[id*=idAddApproverMode]");
            var mode = j$("[id*=idAddApproverMode]").val();
            var stepLabelElem = j$("[id*=idAddApproverStepLabel]");
            var stepLabel = j$("[id*=idAddApproverStepLabel]").val();
            var assigneeTypeElem = j$("[id*=idAddApproverAssigneeType]");
            var assigneeType = j$("[id*=idAddApproverAssigneeType]").val();
            var assigneeNameElem = j$("[id*=idAddApproverAssigneeName]");
            var assigneeName = j$("[id*=idAddApproverAssigneeName]").val();
            var assigneeIdElem = j$("[id*=idAddApproverAssigneeId]");
            var assigneeId = j$("[id*=idAddApproverAssigneeId]").val();
            var comment = j$("[id*=idAddApproverComment]").val();

            // reset errors
            errorTips = j$(".validateTips");
            errorTips.removeClass("slds-has-error");
            
            uiFormFields = j$([]).add(modeElem).add(stepLabelElem).add(assigneeTypeElem).add(assigneeNameElem);
            uiFormFields.removeClass("slds-has-error");

            // perform validation
            var valid = true;
            
            // check mode
            if (typeof mode == "undefined") {
                modeElem.addClass("slds-has-error");
                addError("{!$Label.PleaseCompleteRequiredFields}");
                valid = false;
                
            } else {
                if (!checkLength(modeElem, "Mode", 1, 255)) {
                    modeElem.addClass("slds-has-error");
                    addError("{!$Label.PleaseCompleteRequiredFields}");
                    valid = false;
                
                }
            }
            
            // check step label
            if (typeof stepLabel == "undefined") {
                stepLabelElem.addClass("slds-has-error");
                addError("{!$Label.PleaseCompleteRequiredFields}");
                valid = false;
                
            } else {
                if (!checkLength(stepLabelElem, "Step Label", 1, 255)) {
                    stepLabelElem.addClass("slds-has-error");
                    addError("{!$Label.PleaseCompleteRequiredFields}");
                    valid = false;
                
                }
            }
            
            // check assignee type
            if (typeof assigneeType == "undefined") {
                assigneeTypeElem.addClass("slds-has-error");
                addError("{!$Label.PleaseCompleteRequiredFields}");
                valid = false;
                
            } else {
                if (assigneeType.length < 1) {
                    assigneeTypeElem.addClass("slds-has-error");
                    addError("{!$Label.PleaseCompleteRequiredFields}");
                    valid = false;
                
                }
            }
            
            // check assignee name
            if (typeof assigneeName == "undefined") {
                assigneeNameElem.addClass("slds-has-error");
                addError("{!$Label.PleaseCompleteRequiredFields}");
                valid = false;
                
            } else {
                if (!checkLength(assigneeNameElem, "Approver Name", 1, 255)) {
                    assigneeNameElem.addClass("slds-has-error");
                    addError("{!$Label.PleaseCompleteRequiredFields}");
                    valid = false;
                
                }
                
            }
            
            return valid;

        }

        /**
         * Validate add assignee type form field
         */
        function validateAddAssigneeType() {

            // get form field values from the dialog
            var assigneeTypeElem = j$("[id*=assigneeNameId]");
            var assigneeType = j$("[id*=assigneeNameId]").val();

            // reset errors
            errorTips = j$(".validateTips");
            errorTips.removeClass("slds-has-error");
            
            uiFormFields = j$([]).add(assigneeTypeElem);
            uiFormFields.removeClass("slds-has-error");

            // perform validation
            var valid = true;
            
            // check assignee type
            if (typeof assigneeType == "undefined") {
                assigneeTypeElem.addClass("slds-has-error");
                addError("Please select an assignee type to search");
                valid = false;
                
            } else {
                if (assigneeType.length < 1) {
                    assigneeTypeElem.addClass("slds-has-error");
                    addError("Please select an assignee type to search");
                    valid = false;
                
                }
            }
            
            return valid;

        }

        /**
         * Validate comments form field
         * @param elementId the ID of the target comment text field
         */
        function validateComments(elementId) {

            // get form field values from the dialog
            //var commentElem = j$("[id*=idAddComment]");
            //var comment = j$("[id*=idAddComment]").val();
            var commentElem = elementId;
            var comment = elementId.val();

            // reset errors
            commentElem.removeClass("slds-has-error");

            // perform validation
            var valid = true;
            
            // check comment length
            if (typeof comment == "undefined") {
                commentElem.addClass("slds-has-error");
                valid = false;
                
            } else {
                if (comment.length < 1) {
                    commentElem.addClass("slds-has-error");
                    valid = false;
                
                }
            }
            
            return valid;

        }

        /**
         * Add an approver
         */
        function addApprover() {

            // get form field values from the dialog
            var requestId = j$("[id*=idAddApproverRequestId]").val();
            var mode = j$("[id*=idAddApproverMode]").val();
            var stepLabel = j$("[id*=idAddApproverStepLabel]").val();
            var assigneeType = j$("[id*=idAddApproverAssigneeType]").val();
            var assigneeName = j$("[id*=idAddApproverAssigneeName]").val();
            var assigneeId = j$("[id*=idAddApproverAssigneeId]").val();
            var comment = j$("[id*=idAddApproverComment]").val();

            // add the approver
            invokeDoAddApprover(requestId,
                                mode,
                                stepLabel,
                                assigneeType,
                                assigneeName,
                                assigneeId,
                                comment);
            
            // return false to allow the action to proceed
            return false;

        }

        // ================================================================================
        // REMOVE APPROVER
        // ================================================================================

        /**
         * Show remove approver dialog
         * @param requestId the ID of the approval request context object
         */
        function showRemoveApprover(requestId) {
            
            // store the request id in the global namespace
            j$.APTTUS.RequestId = requestId;
            
            // save the request id on the form
            j$("[id*=idRemoveApproverRequestId]").val(requestId);
            
            // show spinner
            showSpinner();

            // let the controller know we are showing the remove approver dialog
            invokeShowRemoveApprover(requestId);

            return false;
            
        }

        /**
         * Callback when the show is completed
         */
        function onShowRemoveApproverComplete() {
            
            // hide spinner
            hideSpinner();
            
            // show remove approver dialog
            j$("#idRemoveApproverDialogSection").addClass("slds-fade-in-open");
            j$("#idRemoveApproverDialogBackdrop").addClass("slds-backdrop_open");
            j$("#idRemoveApproverPanel").show();
        
            return true;

        }

        /**
         * Hide remove approver dialog
         */
        function hideRemoveApprover() {

            // close the dialog
            j$("#idRemoveApproverDialogSection").removeClass("slds-fade-in-open");
            j$("#idRemoveApproverDialogBackdrop").removeClass("slds-backdrop_open");
            j$("#idRemoveApproverPanel").hide();

        }

        /**
         * Close remove approver dialog
         */
        function closeRemoveApprover() {

            // close the dialog
            hideRemoveApprover();
            
            // clear global namespace parameters
            j$.APTTUS.RequestId = '';
        
            // clear and reset form fields
            j$("[id*=idRemoveApproverMode]").val('');
            
            // clear error fields
            if (typeof errorTips != "undefined") {
                errorTips.removeClass("slds-has-error");
                errorTips.text("Specify information about the approver you are removing for the selected request");

            }
            if (typeof uiFormFields != "undefined") {
                uiFormFields.removeClass("slds-has-error");
                
            }

        }

        /**
         * remove an approver
         */
        function removeApprover() {

            // get form field values from the dialog
            var requestId = j$("[id*=idRemoveApproverRequestId]").val();
            
            // remove the approver
            invokeDoRemoveApprover(requestId);
            
            // return false to allow the action to proceed
            return false;

        }

        // ================================================================================
        // REASSIGN APPROVER
        // ================================================================================

        /**
         * Show reassign approver dialog
         * @param requestId the ID of the approval request context object
         */
        function showReassignApprover(requestId) {
            
            // store the request id in the global namespace
            j$.APTTUS.RequestId = requestId;
            
            // save the request id on the form
            j$("[id*=idReassignApproverRequestId]").val(requestId);
            
            // clear and reset form fields
            j$("[id*=idReassignApproverAssigneeType]").val('');
            j$("[id*=idReassignApproverAssigneeName]").val('');
            j$("[id*=idReassignApproverAssigneeId]").val('');
            j$("[id*=idReassignApproverComment]").val('');

            // show spinner
            showSpinner();

            // let the controller know we are showing the reassign approver dialog
            invokeShowReassignApprover(requestId);

            return false;
            
        }
        
        /**
         * Callback when the show is completed
         */
        function onShowReassignApproverComplete() {
        
            // hide spinner
            hideSpinner();
            
            // show reassign approver dialog
            showReassignApproverDialog();
            
            return true;

        }
        
        /**
         * Show reassign approver dialog
         */
        function showReassignApproverDialog() {

            // close the dialog
            j$("#idReassignApproverDialogSection").addClass("slds-fade-in-open");
            j$("#idReassignApproverDialogBackdrop").addClass("slds-backdrop_open");
            j$("#idReassignApproverPanel").show();

        }

        /**
         * Hide reassign approver dialog
         */
        function hideReassignApproverDialog() {

            // close the dialog
            j$("#idReassignApproverDialogSection").removeClass("slds-fade-in-open");
            j$("#idReassignApproverDialogBackdrop").removeClass("slds-backdrop_open");
            j$("#idReassignApproverPanel").hide();

        }

        /**
         * Close reassign approver dialog
         */
        function closeReassignApprover() {

            // close the dialog
            hideReassignApproverDialog();
            
            // clear global namespace parameters
            j$.APTTUS.RequestId = '';
            j$.APTTUS.AssigneeType = '';
            j$.APTTUS.AssigneeName = '';
            j$.APTTUS.AssigneeId = '';
        
            // clear and reset form fields
            j$("[id*=idReassignApproverAssigneeType]").val('');
            j$("[id*=idReassignApproverAssigneeName]").val('');
            j$("[id*=idReassignApproverAssigneeId]").val('');
            j$("[id*=idReassignApproverComment]").val('');
            
            // clear error fields
            if (typeof errorTips != "undefined") {
                errorTips.removeClass("slds-has-error");
                errorTips.text("Specify information about the approver you are adding for the selected request");

            }
            if (typeof uiFormFields != "undefined") {
                uiFormFields.removeClass("slds-has-error");
                
            }

        }

        /**
         * Validate reassign approver form fields
         */
        function validateReassignApprover() {

            // get form field values from the dialog
            var assigneeTypeElem = j$("[id*=idReassignApproverAssigneeType]");
            var assigneeType = j$("[id*=idReassignApproverAssigneeType]").val();
            var assigneeNameElem = j$("[id*=idReassignApproverAssigneeName]");
            var assigneeName = j$("[id*=idReassignApproverAssigneeName]").val();

            // reset errors
            errorTips = j$(".validateTips");
            errorTips.removeClass("slds-has-error");
            
            uiFormFields = j$([]).add(assigneeTypeElem).add(assigneeNameElem);
            uiFormFields.removeClass("slds-has-error");

            // perform validation
            var valid = true;
            
            // check assignee type
            if (typeof assigneeType == "undefined") {
                assigneeTypeElem.addClass("slds-has-error");
                addError("{!$Label.PleaseCompleteRequiredFields}");
                valid = false;
                
            } else {
                if (assigneeType.length < 1) {
                    assigneeTypeElem.addClass("slds-has-error");
                    addError("{!$Label.PleaseCompleteRequiredFields}");
                    valid = false;
                
                }
            }

            // check assignee name
            if (typeof assigneeName == "undefined") {
                assigneeNameElem.addClass("slds-has-error");
                addError("{!$Label.PleaseCompleteRequiredFields}");
                valid = false;
                
            } else {
                if (!checkLength(assigneeNameElem, "Approver Name", 1, 255)) {
                    assigneeNameElem.addClass("slds-has-error");
                    addError("{!$Label.PleaseCompleteRequiredFields}");
                    valid = false;
                
                }
                
            }
            
            return valid;

        }

        /**
         * Validate reassign assignee type form field
         */
        function validateReassignAssigneeType() {

            // get form field values from the dialog
            var assigneeTypeElem = j$("[id*=assigneeNameId]");
            var assigneeType = j$("[id*=assigneeNameId]").val();

            // reset errors
            errorTips = j$(".validateTips");
            errorTips.removeClass("slds-has-error");
            
            uiFormFields = j$([]).add(assigneeTypeElem);
            uiFormFields.removeClass("slds-has-error");

            // perform validation
            var valid = true;
            
            // check assignee type
            if (typeof assigneeType == "undefined") {
                assigneeTypeElem.addClass("slds-has-error");
                addError("Please select an assignee type to search");
                valid = false;
                
            } else {
                if (assigneeType.length < 1) {
                    assigneeTypeElem.addClass("slds-has-error");
                    addError("Please select an assignee type to search");
                    valid = false;
                
                }
            }
            
            return valid;

        }

        /**
         * Reassign an approval request
         */
        function reassignApprover() {

            // get form field values from the dialog
            var requestId = j$("[id*=idReassignApproverRequestId]").val();
            var assigneeType = j$("[id*=idReassignApproverAssigneeType]").val();
            var assigneeName = j$("[id*=idReassignApproverAssigneeName]").val();
            var assigneeId = j$("[id*=idReassignApproverAssigneeId]").val();
            var comment = j$("[id*=idReassignApproverComment]").val();

            // add the approver
            invokeDoReassignApprover(requestId,
                                    assigneeType,
                                    assigneeName,
                                    assigneeId,
                                    comment);
            
            // return false to allow the action to proceed
            return false;

        }

        // ================================================================================
        // SEARCH APPROVER
        // ================================================================================

        /**
         * Show add approver search dialog
         */
        function showAddApproverSearch() {

            // store form values in the global namespace
            j$.APTTUS.RequestId = j$("[id*=idAddApproverRequestId]").val();
            
            j$.APTTUS.AssigneeType = j$("[id*=idAddApproverAssigneeType]").val();
            j$.APTTUS.AssigneeName = j$("[id*=idAddApproverAssigneeName]").val();
            j$.APTTUS.AssigneeId = j$("[id*=idAddApproverAssigneeId]").val();
            //alert('AssigneeType='+j$.APTTUS.AssigneeType+
                //'; AssigneeName='+j$.APTTUS.AssigneeName+
                //'; AssigneeId='+j$.APTTUS.AssigneeId);
            
            // make sure assignee type is selected
            if (j$.APTTUS.AssigneeType != 'User' &&
                j$.APTTUS.AssigneeType != 'Queue' &&
                j$.APTTUS.AssigneeType != 'Role') {
                
                return validateAddAssigneeType();
            
            }
            
            // show spinner
            showSpinner();

            // let the controller know we are showing the add approver search dialog
            //alert('RequestId='+j$.APTTUS.RequestId+
                //'; AssigneeType='+j$.APTTUS.AssigneeType+
                //'; AssigneeName='+j$.APTTUS.AssigneeName);
            invokeSearchAddApprover(j$.APTTUS.RequestId, j$.APTTUS.AssigneeType, j$.APTTUS.AssigneeName);

            return false;

        }

        /**
         * Callback when the add approver name is changed
         */
        function onChangeAddApproverAssigneeName() {
        
            // clear global namespace parameters
            j$.APTTUS.AssigneeId = '';
            
            // clear and reset form fields
            j$("[id*=idAddApproverAssigneeId]").val('');
            
            return false;
        
        }

        /**
         * Callback when the search is completed
         */
        function onSearchAddApproverComplete() {
        
            // search for the assignee name text
            if (j$.APTTUS.AssigneeType == 'User') {
                userTable = j$('#idAddApproverUserTable').DataTable({
                    "retrieve": true,
                    "autoWidth": true,
                    "columnDefs": [{ "orderable": false, "targets": 0 }],
                    "order": [[1, 'asc']],
                    "processing": true,
                    "searching": false
                });
                userTable.search(j$.APTTUS.AssigneeName).draw();
            
            } else if (j$.APTTUS.AssigneeType == 'Queue') {
                queueTable = j$('#idAddApproverQueueTable').DataTable({
                    "retrieve": true,
                    "autoWidth": true,
                    "columnDefs": [{ "orderable": false, "targets": 0 }],
                    "order": [[1, 'asc']],
                    "processing": true,
                    "searching": false
                });
                queueTable.search(j$.APTTUS.AssigneeName).draw();
            
            } else if (j$.APTTUS.AssigneeType == 'Role') {
                roleTable = j$('#idAddApproverRoleTable').DataTable({
                    "retrieve": true,
                    "autoWidth": true,
                    "columnDefs": [{ "orderable": false, "targets": 0 }],
                    "order": [[1, 'asc']],
                    "processing": true,
                    "searching": false
                });
                roleTable.search(j$.APTTUS.AssigneeName).draw();

            }

            // hide invoking dialog
            hideAddApproverDialog();

            // hide spinner
            hideSpinner();

            // show search dialog
            showAddApproverSearchDialog();
            
            return true;

        }

        /**
         * Select an approver to add
         * @param assigneeType the type of the selected assignee
         * @param assigneeName the name of the selected assignee
         * @param assigneeId the id of the selected assignee
         */
        function selectAddApproverSearch(assigneeType, assigneeName, assigneeId) {

            // store the selected assignee info in the global namespace
            j$.APTTUS.AssigneeType = assigneeType;
            j$.APTTUS.AssigneeName = assigneeName;
            j$.APTTUS.AssigneeId = assigneeId;

            // populate selected assignee info in add approver dialog
            j$("input:text[id*=idAddApproverAssigneeName]").val(assigneeName);
            j$("input:text[id*=idAddApproverAssigneeId]").val(assigneeId);
            
            // hide the add approver search dialog
            hideAddApproverSearchDialog();
            // show the add approver dialog
            showAddApproverDialog();
            
            return false;
        
        }

        /**
         * Show add approver search dialog
         */
        function showAddApproverSearchDialog() {

            // show add approver search dialog
            j$("#idAddApproverSearchDialogSection").addClass("slds-fade-in-open");
            j$("#idAddApproverSearchDialogBackdrop").addClass("slds-backdrop_open");
            j$("#idAddApproverSearchPanel").show();

        }
        
        /**
         * Hide the add approver search dialog
         */
        function hideAddApproverSearchDialog() {

            // hide add approver search dialog
            j$("#idAddApproverSearchDialogSection").removeClass("slds-fade-in-open");
            j$("#idAddApproverSearchDialogBackdrop").removeClass("slds-backdrop_open");
            j$("#idAddApproverSearchPanel").hide();

            // show add approver dialog
            showAddApproverDialog();
        
        }

        /**
         * Show reassign approver search dialog
         */
        function showReassignApproverSearch() {

            // store form values in the global namespace
            j$.APTTUS.RequestId = j$("[id*=idReassignApproverRequestId]").val();
            
            j$.APTTUS.AssigneeType = 'User';
            j$.APTTUS.AssigneeName = j$("[id*=idReassignApproverAssigneeName]").val();
            j$.APTTUS.AssigneeId = j$("[id*=idReassignApproverAssigneeId]").val();
            
            // show spinner
            showSpinner();

            // let the controller know we are showing the reassign approver search dialog
            invokeSearchReassignApprover(j$.APTTUS.RequestId, j$.APTTUS.AssigneeName);

            return false;
            
        }

        /**
         * Callback when the ressign approver name is changed
         */
        function onChangeReassignApproverAssigneeName() {
        
            // clear global namespace parameters
            j$.APTTUS.AssigneeId = '';
            
            // clear and reset form fields
            j$("[id*=idReassignApproverAssigneeId]").val('');
            
            return false;
        
        }

        /**
         * Callback when the search is completed
         */
        function onSearchReassignApproverComplete() {
        
            // search for the assignee name text
            if (j$.APTTUS.AssigneeType == 'User') {
                userTable = j$('#idReassignApproverUserTable').DataTable({
                    "retrieve": true,
                    "autoWidth": true,
                    "columnDefs": [{ "orderable": false, "targets": 0 }],
                    "order": [[1, 'asc']],
                    "processing": true,
                    "searching": false
                });
                userTable.search(j$.APTTUS.AssigneeName).draw();
            
            } else if (j$.APTTUS.AssigneeType == 'Queue') {
                queueTable = j$('#idReassignApproverQueueTable').DataTable({
                    "retrieve": true,
                    "autoWidth": true,
                    "columnDefs": [{ "orderable": false, "targets": 0 }],
                    "order": [[1, 'asc']],
                    "processing": true,
                    "searching": false
                });
                queueTable.search(j$.APTTUS.AssigneeName).draw();
            
            } else if (j$.APTTUS.AssigneeType == 'Role') {
                roleTable = j$('#idReassignApproverRoleTable').DataTable({
                    "retrieve": true,
                    "autoWidth": true,
                    "columnDefs": [{ "orderable": false, "targets": 0 }],
                    "order": [[1, 'asc']],
                    "processing": true,
                    "searching": false
                });
                roleTable.search(j$.APTTUS.AssigneeName).draw();

            }

            // hide invoking dialog
            hideReassignApproverDialog();

            // hide spinner
            hideSpinner();

            // show reassign approver search dialog
            showReassignApproverSearchDialog();
            
            return true;

        }
        
        /**
         * Select an approver to reassign
         * @param assigneeType the type of the selected assignee
         * @param assigneeName the name of the selected assignee
         * @param assigneeId the id of the selected assignee
         */
        function selectReassignApproverSearch(assigneeType, assigneeName, assigneeId) {

            // store the selected assignee info in the global namespace
            j$.APTTUS.AssigneeType = assigneeType;
            j$.APTTUS.AssigneeName = assigneeName;
            j$.APTTUS.AssigneeId = assigneeId;

            // populate selected assignee info in reassign approver dialog
            j$("input:text[id*=idReassignApproverAssigneeName]").val(assigneeName);
            j$("input:text[id*=idReassignApproverAssigneeId]").val(assigneeId);
            
            // hide the reassign approver search dialog
            hideReassignApproverSearchDialog();
            // show the reassign approver dialog
            showReassignApproverDialog();
            
            return false;
        
        }

        /**
         * Show the reassign approver search dialog
         */
        function showReassignApproverSearchDialog() {

            // hide reassign approver search dialog
            j$("#idReassignApproverSearchDialogSection").addClass("slds-fade-in-open");
            j$("#idReassignApproverSearchDialogBackdrop").addClass("slds-backdrop_open");
            j$("#idReassignApproverSearchPanel").show();
        
        }
        /**
         * Hide the reassign approver search dialog
         */
        function hideReassignApproverSearchDialog() {

            // hide reassign approver search dialog
            j$("#idReassignApproverSearchDialogSection").removeClass("slds-fade-in-open");
            j$("#idReassignApproverSearchDialogBackdrop").removeClass("slds-backdrop_open");
            j$("#idReassignApproverSearchPanel").hide();

            // show reassign approver dialog
            showReassignApproverDialog();
        
        }

        // ================================================================================
        // ACTION HANDLERS
        // ================================================================================

        /**
         * Callback when the action button is clicked
         */
        function onActionClick() {
        
            // show spinner
            showSpinner();

            // return false to allow the action to proceed
            return false;

        }
        
        /**
         * Callback when the action is completed
         */
        function onActionComplete() {
        
            // hide spinner
            hideSpinner();
            
            return true;

        }
        
        /**
         * Callback when the add comment button is clicked
         */
        function onActionClickAddComment() {
        
            // get form comments
            j$.APTTUS.Comments = j$("[id*=idAddComment]").val();
            
            // user cannot enter blank comments
            if (!validateComments(j$("[id*=idAddComment]"))) {
                // return false to allow the action to proceed
                return false;
            }
            
            // hide the add comment dialog
            hideAddComment();
            
            // approve the request
            invokeDoAddComments(j$.APTTUS.Comments);

            // clear comments
            j$.APTTUS.Comments = '';
            
            // return false to allow the action to proceed
            return false;

        }
        
        /**
         * Callback when the save button in the add approver dialog is clicked
         */
        function onActionSaveAddApprover() {
        
            // validate form fields
            var ok = validateAddApprover();
            if (!ok) {
                // return false to allow the action to proceed
                return false;
            }
            
            // show spinner
            showSpinner();

            // delay to allow the progress bar to be shown
            setTimeout(function() {
                try {
                    // add the approver
                    addApprover();

                } catch(ex) {
                    var hasErrors = (ex.errors != null);
                    var hasFault = (ex.faultcode != null);
                    
                    if (hasErrors) {
                        //console.log("ex.errors.message="+ex.errors.message);
                    
                    } else if (hasFault) { 
                        //console.log("ex.faultstring="+ex.faultstring);
                        
                    } else {
                        //console.log("ex.message="+ex.message);

                    }
                    
                    // display the error
                    ap_erroralert(ap_cERROR_UNKNOWN, ex);

                } finally {
                    // close the add approver dialog
                    //closeAddApprover();
                    
                    // return false to allow the action to proceed
                    return false;
                    
                }
                
            }, 500);

        }
        
        /**
         * Callback when the cancel button in the add approver dialog is clicked
         */
        function onActionCancelAddApprover() {
        
            // show spinner
            showSpinner();

            // cancel add action
            invokeDoCancelAddApprover();

            // return false to allow the action to proceed
            return false;

        }
        
        /**
         * Callback when the confirm button in the remove approver dialog is clicked
         */
        function onActionConfirmRemoveApprover() {
        
            // show spinner
            showSpinner();

            // delay to allow the progress bar to be shown
            setTimeout(function() {
                try {
                    // remove the approver
                    removeApprover();

                } catch(ex) {
                    var hasErrors = (ex.errors != null);
                    var hasFault = (ex.faultcode != null);
                    
                    if (hasErrors) {
                        //console.log("ex.errors.message="+ex.errors.message);
                    
                    } else if (hasFault) {
                        //console.log("ex.faultstring="+ex.faultstring);
                        
                    } else {
                        //console.log("ex.message="+ex.message);

                    }
                    
                    // display the error
                    ap_erroralert(ap_cERROR_UNKNOWN, ex);

                } finally {
                    // close the remove approver dialog
                    //closeRemoveApprover
                    
                    // return false to allow the action to proceed
                    return false;
                    
                }
                
            }, 500);

        }

        /**
         * Callback when the save button in the reassign approver dialog is clicked
         */
        function onActionSaveReassignApprover() {
        
            // validate form fields
            var ok = validateReassignApprover();
            if (!ok) {
                // return false to allow the action to proceed
                return false;
            }
            
            // show spinner
            showSpinner();

            // delay to allow the progress bar to be shown
            setTimeout(function() {
                try {
                    // reassign the approver
                    reassignApprover();

                } catch(ex) {
                    var hasErrors = (ex.errors != null);
                    var hasFault = (ex.faultcode != null);
                    
                    if (hasErrors) {
                        //console.log("ex.errors.message="+ex.errors.message);
                    
                    } else if (hasFault) {
                        //console.log("ex.faultstring="+ex.faultstring);
                        
                    } else {
                        //console.log("ex.message="+ex.message);

                    }
                    
                    // display the error
                    ap_erroralert(ap_cERROR_UNKNOWN, ex);

                } finally {
                    // close the reassign approver dialog
                    //closeReassignApprover
                    
                    // return false to allow the action to proceed
                    return false;
                    
                }
                
            }, 500);

        }
        
        /**
         * Callback when the cancel button in the reassign approver dialog is clicked
         */
        function onActionCancelReassignApprover() {
        
            // show spinner
            showSpinner();

            // cancel reassign action
            invokeDoCancelReassignApprover();

            // return false to allow the action to proceed
            return false;

        }
        
        // ================================================================================
        // ACTION ICONS
        // ================================================================================

        /**
         * Hide the ellipsis icon and show action icons
         * @param requestId the ID of the approval request context object
         * @param ellipsisIconParentDivKey the ID of the ellipsis icon parent to show
         * @param ellipsisIconDivKey the ID of the ellipsis icon to hide
         * @param actionIconDivKey the ID of the action icons to show
         */
        function showActionIcons(requestId,ellipsisIconParentDivKey,ellipsisIconDivKey,actionIconDivKey) {
            
            // store the request id in the global namespace
            j$.APTTUS.RequestId = requestId;
            
            // hide the ellipsis icon
            j$('[id="'+ellipsisIconDivKey+'"]').hide();
            
            // show the action icons
            j$('[id="'+actionIconDivKey+'"]').show();
            
            // show the parent div
            j$('[id="'+ellipsisIconParentDivKey+'"]').show();

            // return false to allow the action to proceed
            return true;
            
        }
        
        /**
         * Hide action icons and show the ellipsis icon
         * @param requestId the ID of the approval request context object
         * @param ellipsisIconParentDivKey the ID of the ellipsis icon parent to show
         * @param ellipsisIconDivKey the ID of the ellipsis icon to show
         * @param actionIconDivKey the ID of the action icons to hide
         */
        function showEllipsisIcon(requestId,ellipsisIconParentDivKey,ellipsisIconDivKey,actionIconDivKey) {
            
            // store the request id in the global namespace
            j$.APTTUS.RequestId = requestId;
            
            // hide the action icon
            j$('[id="'+actionIconDivKey+'"]').hide();
            
            // show the ellipsis icon
            j$('[id="'+ellipsisIconDivKey+'"]').show();

            // show the parent div
            j$('[id="'+ellipsisIconParentDivKey+'"]').show();

            // return false to allow the action to proceed
            return true;
            
        }
    </script>

    <div class="slds-scope">

    <apex:form id="idMyApprovalsForm" >

        <apex:outputPanel id="idDoDonePanel">
            <script type="text/javascript">
                // make sure jQuery doesn't conflict with any other JS libraries
                j$ = jQuery.noConflict();

                // call this once the page is ready
                j$(document).ready(function() {
                        
                    var pageLoaded = "{!pageLoaded}";
                    var pageURL = "{!JSENCODE(pageURL)}";
                    var siteDomain = "{!siteDomain}";
                    var inClassicMode = "{!$User.UIThemeDisplayed == 'Theme3'}";
                    var inLightningMode = "{!$User.UIThemeDisplayed == 'Theme4d' || $User.UIThemeDisplayed == 'Theme4u'}";
                    var inSf1Mode = "{!$User.UIThemeDisplayed == 'Theme4t'}";
                    //console.log('pageLoaded='+pageLoaded+'\n'+'pageURL='+pageURL+'\n'+'inClassicMode='+inClassicMode+'\n'+'inLightningMode='+inLightningMode+'\n'+'inSf1Mode='+inSf1Mode+'\n'+"{!$User.UIThemeDisplayed}");
                    
                    if (pageLoaded == 'false') {
                        // launch myapprovals in classic or lightning
                        //console.log('calling launchMyApprovals');
                        //launchMyApprovals(inClassicMode, inLightningMode, inSf1Mode);

                    } else {
                        // load approvals
                        //console.log('calling loadMyApprovals');
                        //loadApprovals();

                        //console.log('pageURL='+pageURL);
                        if (pageURL.length > 0) {
                            try {
                                if (inClassicMode == 'false') {
                                    var pos = pageURL.indexOf(siteDomain);
                                    //console.log('pos='+pos);
                                    if (pos == -1) {
                                        //console.log('sforce.one.navigateToURL...');
                                        sforce.one.navigateToURL(pageURL);
                                    } else {
                                        // strip site domain from the URL
                                        var relativePageURL = pageURL.substring(pos + siteDomain.length);
                                        //console.log('relativePageURL='+relativePageURL);
                                        sforce.one.navigateToURL(relativePageURL);
                                    }
                                }
                            }
                            catch(err) {
                            }
                        }
                    }
                    
                });
            </script>
        </apex:outputPanel>

        <apex:outputPanel id="idPagePanel" >
            <apex:outputPanel id="idPagePanelApproveRejectActions">
                <script>
                    function selectTab(event) {
                        try {
                            // get selected tab
                            var activeTab = event.id;
                            j$(".gpSessionTabItem").removeClass("slds-is-active");
                            j$("#"+activeTab).parent().addClass("slds-is-active");

                            // hide other tabs
                            j$(".gpSessionTabContent").each(function() {
                                var clsName = j$(this).attr("class");
                                if (clsName.indexOf("slds-show") != -1) {
                                    j$(this).removeClass("slds-show");
                                    j$(this).addClass("slds-hide");
                                }
                            });

                            // show selected tab
                            var arr = activeTab.split("__");
                            var scopeId = arr[0];
                            j$("#"+scopeId).removeClass("slds-hide");
                            j$("#"+scopeId).addClass("slds-show");

                            // let controller know
                            invokeDoSelectTab(scopeId);

                        }
                        catch(ex) {
                            console.log("ERROR: ex="+ex);

                        }
                        finally {
                            return false;

                        }

                    }

                    // ================================================================================
                    // APPROVE, REJECT, ADD COMMENT
                    // ================================================================================

                    /**
                     * Show approve dialog
                     */
                    function showApprove() {
                        
                        // make sure at least one row is selected
                        var numSelectedRequests = {!numSelectedRequests};
                        if (numSelectedRequests == 0) {
                            alert('{!$Label.SelectAtLeastOneRow}');
                            return false;

                        }

                        // show the dialog
                        j$("#idApproveDialogSection").addClass("slds-fade-in-open");
                        j$("#idApproveDialogBackdrop").addClass("slds-backdrop_open");
                        j$("#idApprovePanel").show();
                        
                        return false;
                        
                    }
        
                    /**
                     * Hide approve dialog
                     */
                    function hideApprove() {

                        // clear form fields
                        j$("[id*=idApproveComment]").val('');

                        // close the dialog
                        j$("#idApproveDialogSection").removeClass("slds-fade-in-open");
                        j$("#idApproveDialogBackdrop").removeClass("slds-backdrop_open");
                        j$("#idApprovePanel").hide();

                    }

                    /**
                     * Show reject dialog
                     */
                    function showReject() {
                        
                        // make sure at least one row is selected
                        var numSelectedRequests = {!numSelectedRequests};
                        if (numSelectedRequests == 0) {
                            alert('{!$Label.SelectAtLeastOneRow}');
                            return false;

                        }

                        // show the dialog
                        j$("#idRejectDialogSection").addClass("slds-fade-in-open");
                        j$("#idRejectDialogBackdrop").addClass("slds-backdrop_open");
                        j$("#idRejectPanel").show();
                        
                        return false;
                        
                    }
                    
                    /**
                     * Hide reject dialog
                     */
                    function hideReject() {

                        // clear form fields
                        j$("[id*=idRejectComment]").val('');

                        // close the dialog
                        j$("#idRejectDialogSection").removeClass("slds-fade-in-open");
                        j$("#idRejectDialogBackdrop").removeClass("slds-backdrop_open");
                        j$("#idRejectPanel").hide();

                    }

                    /**
                     * Show addComment dialog
                     */
                    function showAddComment() {
                        
                        // make sure at least one row is selected
                        var numSelectedRequests = {!numSelectedRequests};
                        if (numSelectedRequests == 0) {
                            alert('{!$Label.SelectAtLeastOneRow}');
                            return false;

                        }

                        // show the dialog
                        j$("#idSaveCommentDialogSection").addClass("slds-fade-in-open");
                        j$("#idSaveCommentDialogBackdrop").addClass("slds-backdrop_open");
                        j$("#idSaveCommentPanel").show();
                        
                        return false;
                        
                    }
        
                    /**
                     * Hide addComment dialog
                     */
                    function hideAddComment() {

                        // clear form fields
                        j$("[id*=idAddComment]").val('');

                        // close the dialog
                        j$("#idSaveCommentDialogSection").removeClass("slds-fade-in-open");
                        j$("#idSaveCommentDialogBackdrop").removeClass("slds-backdrop_open");
                        j$("#idSaveCommentPanel").hide();

                    }

                    /**
                     * Invoke take ownership
                     */
                    function doTakeOwnership() {
                        
                        // make sure at least one row is selected
                        var numSelectedRequests = {!numSelectedRequests};
                        if (numSelectedRequests == 0) {
                            alert('{!$Label.SelectAtLeastOneRow}');
                            return false;

                        }
                        // call action function to invoke controller method
                        invokeDoTakeOwnership();
                        
                        return false;
                        
                    }

                    /**
                     * Callback when the approve button is clicked
                     */
                    function onActionClickApprove() {
                        
                        // get form comments
                        j$.APTTUS.Comments = j$("[id*=idApproveComment]").val();
                        
                        // enforce required comments
                        var requireComments = {!isApprovalCommentsMandatory};
                        // user cannot enter blank comments if required
                        if (requireComments && !validateComments(j$("[id*=idApproveComment]"))) {
                            // return false to allow the action to proceed
                            return false;
                        }
                        
                        // hide the approve dialog
                        hideApprove();
                        
                        // approve the request
                        var processInAsyncMode = {!processActionsInAsyncMode};
                        if (processInAsyncMode) {
                            invokeDoApproveAsync(j$.APTTUS.Comments);

                        } else {
                            invokeDoApproveSync(j$.APTTUS.Comments);

                        }

                        // clear comments
                        j$.APTTUS.Comments = '';
                        
                        // return false to allow the action to proceed
                        return false;

                    }

                    /**
                     * Callback when the reject button is clicked
                     */
                    function onActionClickReject() {
                    
                        // get form comments
                        j$.APTTUS.Comments = j$("[id*=idRejectComment]").val();
                        
                        // enforce required comments
                        var requireComments = {!isRejectionCommentsMandatory};
                        // user cannot enter blank comments if required
                        if (requireComments && !validateComments(j$("[id*=idRejectComment]"))) {
                            // return false to allow the action to proceed
                            return false;
                        }

                        // hide the reject dialog
                        hideReject();
                        
                        // reject the request
                        var processInAsyncMode = {!processActionsInAsyncMode};
                        if (processInAsyncMode) {
                            invokeDoRejectAsync(j$.APTTUS.Comments);

                        } else {
                            invokeDoRejectSync(j$.APTTUS.Comments);

                        }

                        // clear comments
                        j$.APTTUS.Comments = '';
                        
                        // return false to allow the action to proceed
                        return false;

                    }
                </script>
            </apex:outputPanel>

            <!-- header panel -->
            <div id="idHeaderPanel" class="slds-page-header slds-page-header_record-home">
                <div class="slds-page-header__row">
                    <div class="slds-page-header__col-title">
                        <div class="slds-media">
                            <!--<div class="slds-media__figure">
                                <span class="slds-icon_container slds-icon-standard-opportunity" title="{!ctxObjLabel}">
                                    <svg class="slds-icon slds-page-header__icon" aria-hidden="true">
                                        <use xlink:href="/assets/icons/standard-sprite/svg/symbols.svg#opportunity"></use>
                                    </svg>
                                    <span class="slds-assistive-text">{!ctxObjLabel}</span>
                                </span>
                            </div>-->
                            <div class="slds-media__body">
                                <div class="slds-page-header__name">
                                    <div class="slds-page-header__name-title">
                                        <h1>
                                            <span>{!ctxObjLabel}</span>
                                            <!--<span class="slds-page-header__title slds-truncate" title="{!ctxObjName}">{!ctxObjName}</span>-->
                                            <apex:commandLink onclick="return invokeDoDone();"
                                                            rerender="idDoDonePanel" 
                                                            styleClass="slds-page-header__title slds-truncate">{!ctxObjName}</apex:commandLink>
                                        </h1>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slds-page-header__col-actions">
                        <apex:outputPanel id="idHeaderPanelButtons">
                            <div class="slds-page-header__controls">
                                <apex:outputPanel rendered="{!isAllApprovalsTabSelected && hasAllApprovalsTabErrors}">
                                    <div class="slds-page-header__control">
                                        <ul class="slds-button-group-list">
                                            <li>
                                                <apex:commandButton value="{!$Label.Apttus_Approval__Return}"
                                                                    onclick="return invokeDoDone();"
                                                                    rerender="idDoDonePanel" 
                                                                    styleClass="slds-button slds-button_neutral" />
                                            </li>
                                        </ul>
                                    </div>
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!isAllApprovalsTabSelected
                                                            && NOT(hasAllApprovalsTabErrors)
                                                            && allUserApprovals.size > 0
                                                            && NOT(doTakeActionOnEach)}">
                                    <div class="slds-page-header__control">
                                        <ul class="slds-button-group-list">
                                            <li>
                                                <apex:commandButton value="{!$Label.Apttus_Approval__Return}"
                                                                    onclick="return invokeDoDone();"
                                                                    rerender="idDoDonePanel" 
                                                                    styleClass="slds-button slds-button_brand" />
                                            </li>
                                            <li>
                                                <apex:commandButton value="{!$Label.Apttus_Approval__Approve}"
                                                                    onclick="return showApprove();"
                                                                    rendered="{!allApprovalsTabEnableActions}"
                                                                    rerender="idPagePanel" 
                                                                    styleClass="slds-button slds-button_success" />
                                                </li>
                                            <li>
                                                <apex:commandButton value="{!$Label.Apttus_Approval__Reject}"
                                                                    onclick="return showReject();"
                                                                    rendered="{!allApprovalsTabEnableActions}"
                                                                    rerender="idPagePanel" 
                                                                    styleClass="slds-button slds-button_destructive" />
        
                                            </li>
                                            <li>
                                                <apex:commandButton value="{!$Label.Apttus_Approval__SaveComment}"
                                                                    onclick="return showAddComment();"
                                                                    rendered="{!allApprovalsTabEnableActions}"
                                                                    rerender="idPagePanel" 
                                                                    styleClass="slds-button slds-button_neutral" />
                                            </li>
                                        </ul>
                                    </div>
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!isMyApprovalsTabSelected && hasMyApprovalsTabErrors}">
                                    <div class="slds-page-header__control">
                                        <ul class="slds-button-group-list">
                                            <li>
                                                <apex:commandButton value="{!$Label.Apttus_Approval__Return}"
                                                                    onclick="return invokeDoDone();"
                                                                    rerender="idDoDonePanel" 
                                                                    styleClass="slds-button slds-button_neutral" />
                                            </li>
                                        </ul>
                                    </div>
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!isMyApprovalsTabSelected
                                                            && NOT(hasMyApprovalsTabErrors)
                                                            && userApprovals.size > 0
                                                            && NOT(doTakeActionOnEach)}">
                                    <div class="slds-page-header__control">
                                        <ul class="slds-button-group-list">
                                            <li>
                                                <apex:commandButton value="{!$Label.Apttus_Approval__Return}"
                                                                    onclick="return invokeDoDone();"
                                                                    rerender="idDoDonePanel" 
                                                                    styleClass="slds-button slds-button_brand" />
                                            </li>
                                            <li>
                                                <apex:commandButton value="{!$Label.Apttus_Approval__Approve}"
                                                                    onclick="return showApprove();"
                                                                    rendered="{!myApprovalsTabEnableActions}"
                                                                    rerender="idPagePanel" 
                                                                    styleClass="slds-button slds-button_success" />
                                            </li>
                                            <li>
                                                <apex:commandButton value="{!$Label.Apttus_Approval__Reject}"
                                                                    onclick="return showReject();"
                                                                    rendered="{!myApprovalsTabEnableActions}"
                                                                    rerender="idPagePanel" 
                                                                    styleClass="slds-button slds-button_destructive" />
        
                                            </li>
                                            <li>
                                                <apex:commandButton value="{!$Label.Apttus_Approval__SaveComment}"
                                                                    onclick="return showAddComment();"
                                                                    rendered="{!myApprovalsTabEnableActions}"
                                                                    rerender="idPagePanel" 
                                                                    styleClass="slds-button slds-button_neutral" />
                                            </li>
                                        </ul>
                                    </div>
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!isQueueApprovalsTabSelected && hasQueueApprovalsTabErrors}">
                                    <div class="slds-page-header__control">
                                        <ul class="slds-button-group-list">
                                            <li>
                                                <apex:commandButton value="{!$Label.Apttus_Approval__Return}"
                                                                    onclick="return invokeDoDone();"
                                                                    rerender="idDoDonePanel" 
                                                                    styleClass="slds-button slds-button_neutral" />
                                            </li>
                                        </ul>
                                    </div>
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!isQueueApprovalsTabSelected
                                                            && NOT(hasQueueApprovalsTabErrors)
                                                            && queueRoleApprovals.size > 0
                                                            && NOT(doTakeActionOnEach)}">
                                    <div class="slds-page-header__control">
                                        <ul class="slds-button-group-list">
                                            <li>
                                                <apex:commandButton value="{!$Label.Apttus_Approval__Return}"
                                                                    onclick="return invokeDoDone();"
                                                                    rerender="idDoDonePanel" 
                                                                    styleClass="slds-button slds-button_brand" />
                                            </li>
                                            <li>
                                                <apex:commandButton value="{!$Label.Apttus_Approval__TakeOwnership}"
                                                                    onclick="return doTakeOwnership();"
                                                                    rendered="{!hasSelectableQueueRoleApprovals}"
                                                                    rerender="idPagePanel" 
                                                                    styleClass="slds-button slds-button_neutral" />
                                            </li>
                                        </ul>
                                    </div>
                                </apex:outputPanel>
                            </div>
                        </apex:outputPanel>
                    </div>
                </div>
                <div class="slds-page-header__row">
                    <div class="slds-page-header__col-meta">
                    <p class="slds-page-header__meta-text">{!$Label.ApprovalStatus}: {!ctxObjApprovalStatus}</p>
                    </div>
                </div>
            </div>
        
            <!-- body panel -->
            <div id="idTabPanel" class="slds-tabs_default">
                <ul class="slds-tabs_default__nav" role="tablist">
                    <li class="slds-tabs_default__item gpSessionTabItem" title="{!$Label.AllApprovals}" role="presentation">
                        <a id="allApprovalsTab__item" class="slds-tabs_default__link" href="#" role="tab" tabindex="-1" aria-selected="false" aria-controls="allApprovalsTab" onclick="return selectTab(this);">
                            {!$Label.AllApprovals} ({!numAllApprovalsRequests})
                        </a>
                    </li>
                    <li class="slds-tabs_default__item gpSessionTabItem slds-is-active " title="{!$Label.Apttus_Approval__MyApprovals}" role="presentation">
                        <a id="myApprovalsTab__item" class="slds-tabs_default__link" href="#" role="tab" tabindex="-1" aria-selected="false" aria-controls="myApprovalsTab" onclick="return selectTab(this);">
                            {!$Label.Apttus_Approval__MyApprovals} ({!numUserApprovalsRequests})
                        </a>
                    </li>
                    <li class="slds-tabs_default__item gpSessionTabItem" title="{!$Label.MyQueueRoleApprovals}" role="presentation">
                        <a id="queueApprovalsTab__item" class="slds-tabs_default__link" href="#" role="tab" tabindex="-1" aria-selected="false" aria-controls="queueApprovalsTab" onclick="return selectTab(this);">
                            {!$Label.MyQueueRoleApprovals} ({!numQueueRoleApprovalsRequests})
                        </a>
                    </li>
                </ul>
                <apex:outputPanel id="idTabPanelContent">
                    <div id="allApprovalsTab" class="slds-tabs_default__content slds-show gpSessionTabContent" role="tabpanel" aria-labelledby="allApprovalsTab__item">
                        <apex:pageBlock rendered="{!isAllApprovalsTabSelected && hasAllApprovalsTabErrors}">
                            <apex:pageMessages />
                        </apex:pageBlock>
                        <apex:outputPanel id="idAllApprovalsTabPageBlock" rendered="{!isAllApprovalsTabSelected && allUserApprovals.size > 0 && NOT(doTakeActionOnEach)}">
                            <apex:pageBlock id="idAllApprovalsTabSelectAllPanel">
                                <apex:inputCheckbox onclick="invokeDoSelectAll();" value="{!allAllTabSelected}" label="{!$Label.Apttus_Approval__SelectUnselectAll}" title="{!$Label.Apttus_Approval__SelectUnselectAll}" />
                                <apex:outputText value="{!numSelectableRequestsMsg}" />                         
                            </apex:pageBlock>
                            <apex:repeat value="{!allUserApprovals}" var="anApproval">
                                <apex:pageBlock title="{!anApproval.stepName}">
                                    <apex:repeat value="{!anApproval.stepRequests}" var="stepRequest">
                                        <apex:outputPanel id="idAllApprovalsStepRequestHeaderDisplayField"
                                                            layout="block"
                                                            styleClass="headerDisplayFieldPanel" 
                                                            rendered="{!stepRequest.headerDisplayField != null
                                                                    && stepRequest.doRenderDisplayFields}">
                                            <div class="headerDisplayFieldLabel">
                                                <apex:outputLabel rendered="{!stepRequest.headerDisplayFieldInfo.IsLocal}"
                                                                    value="{!$ObjectType[stepRequest.ctxObjectType].fields[stepRequest.headerDisplayField].Label}"
                                                                    style="margin-bottom:0px;" />
                                                <apex:outputLabel rendered="{!NOT(stepRequest.headerDisplayFieldInfo.IsLocal)}"
                                                                    value="{!stepRequest.headerDisplayFieldInfo.Label}"
                                                                    style="margin-bottom:0px;" />
                                            </div>
                                            <div class="headerDisplayFieldValue">
                                                <apex:outputField value="{!stepRequest.ctxObject[stepRequest.headerDisplayField]}" />
                                            </div>
                                        </apex:outputPanel>
                                        <div class="cf">
                                            <apex:outputPanel id="idAllApprovalsStepRequestApprovalStatus"
                                                                layout="block"
                                                                style="float:left;width:15%;">
                                                    <span class="approvalStatusValueRed aptColor-red">{!stepRequest.parentApprovalStatus}</span>
                                                <apex:repeat >
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Approval Required'}">
                                                    <span class="apttusIcon-attention aptColor-red">&nbsp;</span>
                                                    <span class="approvalStatusValueRed aptColor-red">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Pending Approval'}">
                                                    <span class="apttusIcon-clock aptColor-yellow">&nbsp;</span>
                                                    <span class="approvalStatusValueYellow aptColor-yellow">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Notified'}">
                                                    <span class="apttusIcon-ok aptColor-green">&nbsp;</span>
                                                    <span class="approvalStatusValueGreen aptColor-green">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Approved'}">
                                                    <span class="apttusIcon-ok aptColor-green">&nbsp;</span>
                                                    <span class="approvalStatusValueGreen aptColor-green">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Rejected'}">
                                                    <span class="apttusIcon-cancel aptColor-red">&nbsp;</span>
                                                    <span class="approvalStatusValueRed aptColor-red">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Cancelled'}">
                                                    <span class="apttusIcon-cancel aptColor-black">&nbsp;</span>
                                                    <span class="approvalStatusValueBlack aptColor-black">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                </apex:repeat>
                                            </apex:outputPanel>
                                            <apex:outputPanel id="idAllApprovalsStepRequestDisplayFields"
                                                                layout="block"
                                                                style="float:left; width:85%; line-height: 1.3; margin-bottom:10px;"
                                                                rendered="{!stepRequest.displayFieldInfo.size > 0
                                                                        && stepRequest.doRenderDisplayFields}">

                                                <apex:repeat value="{!stepRequest.displayFieldInfo}" var="fi">
                                                    <div class="displayFieldPanel">
                                                        <apex:outputText value="{!fi.label}:"
                                                                            styleClass="displayFieldLabel" />&nbsp;&nbsp;
                                                        <apex:outputField value="{!stepRequest.ctxObject[fi.name]}"
                                                                            styleClass="displayFieldValue" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                    </div>
                                                </apex:repeat>
                                            </apex:outputPanel>
                                        </div>
                                        <apex:pageBlockTable id="idAllApprovalsStepRequestsTable"
                                                                value="{!stepRequest.SelectApprovalRequests}"
                                                                var="approvalReq">
                                            <apex:column width="3%"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" >
                                                <apex:inputCheckbox onclick="invokeDoSelect('{!approvalReq.request.Id}');" value="{!approvalReq.selected}" rendered="{!approvalReq.enableSelect}" />
                                            </apex:column>
                                            <apex:column width="20%" value="{!approvalReq.request.Apttus_Approval__StepLabel__c}" 
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" />
                                            <apex:column width="5%"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}">
                                                <div id="{!approvalReq.ellipsisIconParentDivKey}" 
                                                    onmouseover="return showActionIcons('{!approvalReq.request.Id}','{!approvalReq.ellipsisIconParentDivKey}','{!approvalReq.ellipsisIconDivKey}','{!approvalReq.actionIconDivKey}');"
                                                    onmouseout="return showEllipsisIcon('{!approvalReq.request.Id}','{!approvalReq.ellipsisIconParentDivKey}','{!approvalReq.ellipsisIconDivKey}','{!approvalReq.actionIconDivKey}');">
                                                    <div id="{!approvalReq.ellipsisIconDivKey}">
                                                        <apex:outputPanel rendered="{!approvalReq.hasActions}">
                                                            <apex:image url="{!$Resource.Apttus_Approval__Image_Approver_Action}"
                                                                        title="{!$Label.Apttus_Approval__ApproverActions}"
                                                                        alt="{!$Label.Apttus_Approval__ApproverActions}" />
                                                        </apex:outputPanel>
                                                    </div>
                                                    <div id="{!approvalReq.actionIconDivKey}" style="display:none;">
                                                        <apex:outputPanel rendered="{!approvalReq.hasActions}">
                                                            <apex:commandLink rendered="{!approvalReq.canReassignApprover}"
                                                                                onclick="return showReassignApprover('{!approvalReq.request.Id}');">
                                                                <apex:image url="{!$Resource.Apttus_Approval__Image_Approver_Reassign}"
                                                                            title="{!$Label.Apttus_Approval__ReassignApprover}"
                                                                            alt="{!$Label.Apttus_Approval__ReassignApprover}" />
                                                            </apex:commandLink>
                                                            <apex:commandLink rendered="{!approvalReq.canAddApprover}"
                                                                                onclick="return showAddApprover('{!approvalReq.request.Id}');">
                                                                <apex:image url="{!$Resource.Apttus_Approval__Image_Approver_Add}"
                                                                            title="{!$Label.Apttus_Approval__AddApprover}"
                                                                            alt="{!$Label.Apttus_Approval__AddApprover}" />
                                                            </apex:commandLink>
                                                            <apex:commandLink rendered="{!approvalReq.canRemoveApprover}"
                                                                                onclick="return showRemoveApprover('{!approvalReq.request.Id}');">
                                                                <apex:image url="{!$Resource.Apttus_Approval__Image_Approver_Remove}"
                                                                            title="{!$Label.Apttus_Approval__RemoveApprover}"
                                                                            alt="{!$Label.Apttus_Approval__RemoveApprover}" />
                                                            </apex:commandLink>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </apex:column>
                                            <apex:column width="5%" value="{!approvalReq.request.Apttus_Approval__StepSequence__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" />
                                            <apex:column width="5%" value="{!approvalReq.request.Apttus_Approval__Sequence__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" />
                                            <apex:column width="10%"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" >
                                                <apex:facet name="header">
                                                    <apex:outputText value="{!$Label.Apttus_Approval__Status}"></apex:outputText>
                                                </apex:facet>
                                                <apex:outputText value="{!approvalReq.request.Apttus_Approval__Approval_Status__c}" 
                                                                    rendered="{!approvalReq.request.Apttus_Approval__Approval_Status__c == 'Approved'}"
                                                                    styleClass="approvalStatusValueGreen" />
                                                <apex:outputText value="{!approvalReq.request.Apttus_Approval__Approval_Status__c}" 
                                                                    rendered="{!approvalReq.request.Apttus_Approval__Approval_Status__c == 'Rejected'}"
                                                                    styleClass="approvalStatusValueRed" />
                                                <apex:outputText value="{!approvalReq.request.Apttus_Approval__Approval_Status__c}" 
                                                                    rendered="{!NOT(approvalReq.request.Approval_Status__c == 'Approved')
                                                                            && NOT(approvalReq.request.Approval_Status__c == 'Rejected')}"
                                                                    style="color:black;" />
                                            </apex:column>
                                            <apex:column width="10%" value="{!approvalReq.request.Apttus_Approval__Assigned_To_Name__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" />
                                            <apex:column width="10%" value="{!approvalReq.request.Apttus_Approval__DelegateApproverNames__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}">
                                                <apex:facet name="header">
                                                    <apex:outputText value="{!$Label.Apttus_Approval__DelegateApprovers}"></apex:outputText>
                                                </apex:facet>
                                            </apex:column>
                                            <apex:column width="20%" value="{!approvalReq.request.Apttus_Approval__Request_Comments__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" />
                                            <apex:column width="24%" value="{!approvalReq.request.Apttus_Approval__Approver_Comments__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}">
                                                <apex:facet name="header">
                                                    <apex:outputText value="{!$Label.Apttus_Approval__ApprovalHistory}"></apex:outputText>
                                                </apex:facet>
                                            </apex:column>
                                        </apex:pageBlockTable>
                                    </apex:repeat>
                                    <apex:pageBlockSection id="idComments1" columns="1"
                                                            rendered="{!anApproval.submitComment1Text != null}">
                                        <apex:outputLabel value="{!$Label[comment1Label]}" style="font-weight:bold;" />
                                        <apex:repeat value="{!anApproval.submitComment1Lines}" var="cLine">
                                            <apex:outputText value="{!cLine}" style="line-height:1.0;" />
                                        </apex:repeat>
                                    </apex:pageBlockSection>
                                    <apex:pageBlockSection id="idComments2" columns="1"
                                                            rendered="{!anApproval.submitComment2Text != null}">
                                        <apex:outputLabel value="{!$Label[comment2Label]}" style="font-weight:bold;" />
                                        <apex:repeat value="{!anApproval.submitComment2Lines}" var="cLine">
                                            <apex:outputText value="{!cLine}" style="line-height:1.0;" />
                                        </apex:repeat>
                                    </apex:pageBlockSection>
                                    <apex:pageBlockSection id="idComments3" columns="1"
                                                            rendered="{!anApproval.submitComment3Text != null}">
                                        <apex:outputLabel value="{!$Label[comment3Label]}" style="font-weight:bold;" />
                                        <apex:repeat value="{!anApproval.submitComment3Lines}" var="cLine">
                                            <apex:outputText value="{!cLine}" style="line-height:1.0;" />
                                        </apex:repeat>
                                    </apex:pageBlockSection>
                                </apex:pageBlock>
                            </apex:repeat>
                            <apex:pageBlock title="{!$Label.Apttus_Approval__OtherApproverComments}" rendered="{!completionComments.size > 0}">
                                <apex:pageBlockTable value="{!completionComments}" var="approverComments">
                                    <apex:column value="{!approverComments.Apttus_Approval__Actual_Approver__c}" />
                                    <apex:column value="{!approverComments.Apttus_Approval__StepLabel__c}" />
                                    <apex:column value="{!approverComments.Apttus_Approval__Approver_Comments__c}" />
                                </apex:pageBlockTable>
                            </apex:pageBlock>
                        </apex:outputPanel>
                    </div>
                    <div id="myApprovalsTab" class="slds-tabs_default__content slds-show gpSessionTabContent" role="tabpanel" aria-labelledby="myApprovalsTab__item">
                        <apex:pageBlock rendered="{!isMyApprovalsTabSelected  && hasMyApprovalsTabErrors}">
                            <apex:pageMessages />
                        </apex:pageBlock>
                        <apex:outputPanel id="idMyApprovalsTabPageBlock" rendered="{!isMyApprovalsTabSelected && userApprovals.size > 0 && NOT(doTakeActionOnEach)}">
                            <apex:pageBlock id="idMyApprovalsTabSelectAllPanel">
                                <apex:inputCheckbox onclick="invokeDoSelectAll();" value="{!allMyTabSelected}" label="{!$Label.Apttus_Approval__SelectUnselectAll}" title="{!$Label.Apttus_Approval__SelectUnselectAll}" />
                                <apex:outputText value="{!numSelectableRequestsMsg}" />                         
                            </apex:pageBlock>
                            <apex:repeat value="{!userApprovals}" var="userApproval">
                                <apex:pageBlock title="{!userApproval.stepName}">
                                    <apex:repeat value="{!userApproval.stepRequests}" var="stepRequest">
                                        <apex:outputPanel id="idMyApprovalsStepRequestHeaderDisplayField"
                                                            layout="block"
                                                            styleClass="headerDisplayFieldPanel" 
                                                            rendered="{!stepRequest.headerDisplayField != null
                                                                    && stepRequest.doRenderDisplayFields}">
                                            <div class="headerDisplayFieldLabel">
                                                <apex:outputLabel rendered="{!stepRequest.headerDisplayFieldInfo.IsLocal}"
                                                                    value="{!$ObjectType[stepRequest.ctxObjectType].fields[stepRequest.headerDisplayField].Label}"
                                                                    style="margin-bottom:0px;" />
                                                <apex:outputLabel rendered="{!NOT(stepRequest.headerDisplayFieldInfo.IsLocal)}"
                                                                    value="{!stepRequest.headerDisplayFieldInfo.Label}"
                                                                    style="margin-bottom:0px;" />
                                            </div>
                                            <div class="headerDisplayFieldValue">
                                                <apex:outputField value="{!stepRequest.ctxObject[stepRequest.headerDisplayField]}" />
                                            </div>
                                        </apex:outputPanel>
                                        <div class="cf">
                                            <apex:outputPanel id="idMyApprovalsStepRequestApprovalStatus"
                                                                layout="block"
                                                                style="float:left;width:15%;">
                                                    <span class="approvalStatusValueRed aptColor-red">{!stepRequest.parentApprovalStatus}</span>
                                                <apex:repeat >
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Approval Required'}">
                                                    <span class="apttusIcon-attention aptColor-red">&nbsp;</span>
                                                    <span class="approvalStatusValueRed aptColor-red">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Pending Approval'}">
                                                    <span class="apttusIcon-clock aptColor-yellow">&nbsp;</span>
                                                    <span class="approvalStatusValueYellow aptColor-yellow">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Notified'}">
                                                    <span class="apttusIcon-ok aptColor-green">&nbsp;</span>
                                                    <span class="approvalStatusValueGreen aptColor-green">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Approved'}">
                                                    <span class="apttusIcon-ok aptColor-green">&nbsp;</span>
                                                    <span class="approvalStatusValueGreen aptColor-green">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Rejected'}">
                                                    <span class="apttusIcon-cancel aptColor-red">&nbsp;</span>
                                                    <span class="approvalStatusValueRed aptColor-red">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Cancelled'}">
                                                    <span class="apttusIcon-cancel aptColor-black">&nbsp;</span>
                                                    <span class="approvalStatusValueBlack aptColor-black">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                </apex:repeat>
                                            </apex:outputPanel>
                                            <apex:outputPanel id="idMyApprovalsStepRequestDisplayFields"
                                                                layout="block"
                                                                style="float:left; width:85%; line-height: 1.3; margin-bottom:10px;"
                                                                rendered="{!stepRequest.displayFieldInfo.size > 0
                                                                        && stepRequest.doRenderDisplayFields}">
                                                                        
                                                <apex:repeat value="{!stepRequest.displayFieldInfo}" var="fi">
                                                    <div class="displayFieldPanel">
                                                        <apex:outputText value="{!fi.label}:"
                                                                            styleClass="displayFieldLabel" />&nbsp;&nbsp;
                                                        <apex:outputField value="{!stepRequest.ctxObject[fi.name]}"
                                                                            styleClass="displayFieldValue" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                    </div>
                                                </apex:repeat>
                                            </apex:outputPanel>
                                        </div>
                                        <apex:pageBlockTable id="idMyApprovalsStepRequestsTable"
                                                                value="{!stepRequest.SelectApprovalRequests}"
                                                                var="approvalReq">
                                            <apex:column width="3%"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" >
                                                <apex:inputCheckbox onclick="invokeDoSelect('{!approvalReq.request.Id}');" value="{!approvalReq.selected}" rendered="{!approvalReq.enableSelect}" />
                                            </apex:column>
                                            <apex:column width="20%" value="{!approvalReq.request.Apttus_Approval__StepLabel__c}" 
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" />
                                            <apex:column width="5%"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}">
                                                <div id="{!approvalReq.ellipsisIconParentDivKey}" 
                                                    onmouseover="return showActionIcons('{!approvalReq.request.Id}','{!approvalReq.ellipsisIconParentDivKey}','{!approvalReq.ellipsisIconDivKey}','{!approvalReq.actionIconDivKey}');"
                                                    onmouseout="return showEllipsisIcon('{!approvalReq.request.Id}','{!approvalReq.ellipsisIconParentDivKey}','{!approvalReq.ellipsisIconDivKey}','{!approvalReq.actionIconDivKey}');">
                                                    <div id="{!approvalReq.ellipsisIconDivKey}">
                                                        <apex:outputPanel rendered="{!approvalReq.hasActions}">
                                                            <apex:image url="{!$Resource.Apttus_Approval__Image_Approver_Action}"
                                                                        title="{!$Label.Apttus_Approval__ApproverActions}"
                                                                        alt="{!$Label.Apttus_Approval__ApproverActions}" />
                                                        </apex:outputPanel>
                                                    </div>
                                                    <div id="{!approvalReq.actionIconDivKey}" style="display:none;">
                                                        <apex:outputPanel rendered="{!approvalReq.hasActions}">
                                                            <apex:commandLink rendered="{!approvalReq.canReassignApprover}"
                                                                                onclick="return showReassignApprover('{!approvalReq.request.Id}');">
                                                                <apex:image url="{!$Resource.Apttus_Approval__Image_Approver_Reassign}"
                                                                            title="{!$Label.Apttus_Approval__ReassignApprover}"
                                                                            alt="{!$Label.Apttus_Approval__ReassignApprover}" />
                                                            </apex:commandLink>
                                                            <apex:commandLink rendered="{!approvalReq.canAddApprover}"
                                                                                onclick="return showAddApprover('{!approvalReq.request.Id}');">
                                                                <apex:image url="{!$Resource.Apttus_Approval__Image_Approver_Add}"
                                                                            title="{!$Label.Apttus_Approval__AddApprover}"
                                                                            alt="{!$Label.Apttus_Approval__AddApprover}" />
                                                            </apex:commandLink>
                                                            <apex:commandLink rendered="{!approvalReq.canRemoveApprover}"
                                                                                onclick="return showRemoveApprover('{!approvalReq.request.Id}');">
                                                                <apex:image url="{!$Resource.Apttus_Approval__Image_Approver_Remove}"
                                                                            title="{!$Label.Apttus_Approval__RemoveApprover}"
                                                                            alt="{!$Label.Apttus_Approval__RemoveApprover}" />
                                                            </apex:commandLink>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </apex:column>
                                            <apex:column width="5%" value="{!approvalReq.request.Apttus_Approval__StepSequence__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" />
                                            <apex:column width="5%" value="{!approvalReq.request.Apttus_Approval__Sequence__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" />
                                            <apex:column width="10%"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" >
                                                <apex:facet name="header">
                                                    <apex:outputText value="{!$Label.Apttus_Approval__Status}"></apex:outputText>
                                                </apex:facet>
                                                <apex:outputText value="{!approvalReq.request.Apttus_Approval__Approval_Status__c}" 
                                                                    rendered="{!approvalReq.request.Apttus_Approval__Approval_Status__c == 'Approved'}"
                                                                    styleClass="approvalStatusValueGreen" />
                                                <apex:outputText value="{!approvalReq.request.Apttus_Approval__Approval_Status__c}" 
                                                                    rendered="{!approvalReq.request.Apttus_Approval__Approval_Status__c == 'Rejected'}"
                                                                    styleClass="approvalStatusValueRed" />
                                                <apex:outputText value="{!approvalReq.request.Apttus_Approval__Approval_Status__c}" 
                                                                    rendered="{!NOT(approvalReq.request.Approval_Status__c == 'Approved')
                                                                            && NOT(approvalReq.request.Approval_Status__c == 'Rejected')}"
                                                                    style="color:black;" />
                                            </apex:column>
                                            <apex:column width="10%" value="{!approvalReq.request.Apttus_Approval__Assigned_To_Name__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" />
                                            <apex:column width="10%" value="{!approvalReq.request.Apttus_Approval__DelegateApproverNames__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}">
                                                <apex:facet name="header">
                                                    <apex:outputText value="{!$Label.Apttus_Approval__DelegateApprovers}"></apex:outputText>
                                                </apex:facet>
                                            </apex:column>
                                            <apex:column width="20%" value="{!approvalReq.request.Apttus_Approval__Request_Comments__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" />
                                            <apex:column width="24%" value="{!approvalReq.request.Apttus_Approval__Approver_Comments__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}">
                                                <apex:facet name="header">
                                                    <apex:outputText value="{!$Label.Apttus_Approval__ApprovalHistory}"></apex:outputText>
                                                </apex:facet>
                                            </apex:column>
                                        </apex:pageBlockTable>
                                    </apex:repeat>
                                    <apex:pageBlockSection id="idComments1" columns="1"
                                                            rendered="{!userApproval.submitComment1Text != null}">
                                        <apex:outputLabel value="{!$Label[comment1Label]}" style="font-weight:bold;" />
                                        <apex:repeat value="{!userApproval.submitComment1Lines}" var="cLine">
                                            <apex:outputText value="{!cLine}" style="line-height:1.0;" />
                                        </apex:repeat>
                                    </apex:pageBlockSection>
                                    <apex:pageBlockSection id="idComments2" columns="1"
                                                            rendered="{!userApproval.submitComment2Text != null}">
                                        <apex:outputLabel value="{!$Label[comment2Label]}" style="font-weight:bold;" />
                                        <apex:repeat value="{!userApproval.submitComment2Lines}" var="cLine">
                                            <apex:outputText value="{!cLine}" style="line-height:1.0;" />
                                        </apex:repeat>
                                    </apex:pageBlockSection>
                                    <apex:pageBlockSection id="idComments3" columns="1"
                                                            rendered="{!userApproval.submitComment3Text != null}">
                                        <apex:outputLabel value="{!$Label[comment3Label]}" style="font-weight:bold;" />
                                        <apex:repeat value="{!userApproval.submitComment3Lines}" var="cLine">
                                            <apex:outputText value="{!cLine}" style="line-height:1.0;" />
                                        </apex:repeat>
                                    </apex:pageBlockSection>
                                </apex:pageBlock>
                            </apex:repeat>
                            <apex:pageBlock title="{!$Label.Apttus_Approval__OtherApproverComments}" rendered="{!completionComments.size > 0}">
                                <apex:pageBlockTable value="{!completionComments}" var="approverComments">
                                    <apex:column value="{!approverComments.Apttus_Approval__Actual_Approver__c}" />
                                    <apex:column value="{!approverComments.Apttus_Approval__StepLabel__c}" />
                                    <apex:column value="{!approverComments.Apttus_Approval__Approver_Comments__c}" />
                                </apex:pageBlockTable>
                            </apex:pageBlock>
                        </apex:outputPanel>
                    </div>
                    <div id="queueApprovalsTab" class="slds-tabs_default__content slds-show gpSessionTabContent" role="tabpanel" aria-labelledby="queueApprovalsTab__item">
                        <apex:pageBlock rendered="{!isQueueApprovalsTabSelected && hasQueueApprovalsTabErrors}">
                            <apex:pageMessages />
                        </apex:pageBlock>
                        <apex:outputPanel id="idQueueApprovalsTabPageBlock" rendered="{!isQueueApprovalsTabSelected && queueRoleApprovals.size > 0 && NOT(doTakeActionOnEach)}">
                            <apex:pageBlock id="idQueueApprovalsTabSelectAllPanel">
                                <apex:inputCheckbox onclick="invokeDoSelectAll();" value="{!allQueueTabSelected}" label="{!$Label.Apttus_Approval__SelectUnselectAll}" title="{!$Label.Apttus_Approval__SelectUnselectAll}" />
                                <apex:outputText value="{!numSelectableRequestsMsg}" />
                            </apex:pageBlock>
                            <apex:repeat value="{!queueRoleApprovals}" var="qrApproval">
                                <apex:pageBlock title="{!qrApproval.stepName}">
                                    <apex:repeat value="{!qrApproval.stepRequests}" var="stepRequest">
                                        <apex:outputPanel id="idQueueApprovalsStepRequestHeaderDisplayField"
                                                            layout="block"
                                                            styleClass="headerDisplayFieldPanel" 
                                                            rendered="{!stepRequest.headerDisplayField != null
                                                                    && stepRequest.doRenderDisplayFields}">
                                            <div class="headerDisplayFieldLabel">
                                                <apex:outputLabel rendered="{!stepRequest.headerDisplayFieldInfo.IsLocal}"
                                                                    value="{!$ObjectType[stepRequest.ctxObjectType].fields[stepRequest.headerDisplayField].Label}"
                                                                    style="margin-bottom:0px;" />
                                                <apex:outputLabel rendered="{!NOT(stepRequest.headerDisplayFieldInfo.IsLocal)}"
                                                                    value="{!stepRequest.headerDisplayFieldInfo.Label}"
                                                                    style="margin-bottom:0px;" />
                                            </div>
                                            <div class="headerDisplayFieldValue">
                                                <apex:outputField value="{!stepRequest.ctxObject[stepRequest.headerDisplayField]}" />
                                            </div>
                                        </apex:outputPanel>
                                        <div class="cf">
                                            <apex:outputPanel id="idQueueApprovalsStepRequestApprovalStatus"
                                                                layout="block"
                                                                style="float:left;width:15%;">
                                                    <span class="approvalStatusValueRed aptColor-red">{!stepRequest.parentApprovalStatus}</span>
                                                <apex:repeat >
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Approval Required'}">
                                                    <span class="apttusIcon-attention aptColor-red">&nbsp;</span>
                                                    <span class="approvalStatusValueRed aptColor-red">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Pending Approval'}">
                                                    <span class="apttusIcon-clock aptColor-yellow">&nbsp;</span>
                                                    <span class="approvalStatusValueYellow aptColor-yellow">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Notified'}">
                                                    <span class="apttusIcon-ok aptColor-green">&nbsp;</span>
                                                    <span class="approvalStatusValueGreen aptColor-green">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Approved'}">
                                                    <span class="apttusIcon-ok aptColor-green">&nbsp;</span>
                                                    <span class="approvalStatusValueGreen aptColor-green">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Rejected'}">
                                                    <span class="apttusIcon-cancel aptColor-red">&nbsp;</span>
                                                    <span class="approvalStatusValueRed aptColor-red">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!stepRequest.parentApprovalStatus == 'Cancelled'}">
                                                    <span class="apttusIcon-cancel aptColor-black">&nbsp;</span>
                                                    <span class="approvalStatusValueBlack aptColor-black">{!stepRequest.parentApprovalStatus}</span>
                                                </apex:outputPanel>
                                                </apex:repeat>
                                            </apex:outputPanel>
                                            <apex:outputPanel id="idQueueApprovalsStepRequestDisplayFields"
                                                                layout="block"
                                                                style="float:left; width:85%; line-height: 1.3; margin-bottom:10px;"
                                                                rendered="{!stepRequest.displayFieldInfo.size > 0
                                                                        && stepRequest.doRenderDisplayFields}">
                                                                        
                                                <apex:repeat value="{!stepRequest.displayFieldInfo}" var="fi">
                                                    <div class="displayFieldPanel">
                                                        <apex:outputText value="{!fi.label}:"
                                                                            styleClass="displayFieldLabel" />&nbsp;&nbsp;
                                                        <apex:outputField value="{!stepRequest.ctxObject[fi.name]}"
                                                                            styleClass="displayFieldValue" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                    </div>
                                                </apex:repeat>
                                            </apex:outputPanel>
                                        </div>
                                        <apex:pageBlockTable id="idQueueApprovalsStepRequestsTable"
                                                                value="{!stepRequest.SelectApprovalRequests}"
                                                                var="approvalReq">
                                            <apex:column width="3%"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" >
                                                <apex:inputCheckbox onclick="invokeDoSelect('{!approvalReq.request.Id}');" value="{!approvalReq.selected}" rendered="{!approvalReq.enableSelect}" />
                                            </apex:column>
                                            <apex:column width="20%" value="{!approvalReq.request.Apttus_Approval__StepLabel__c}" 
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" />
                                            <apex:column width="5%"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}">
                                                <div id="{!approvalReq.ellipsisIconParentDivKey}" 
                                                    onmouseover="return showActionIcons('{!approvalReq.request.Id}','{!approvalReq.ellipsisIconParentDivKey}','{!approvalReq.ellipsisIconDivKey}','{!approvalReq.actionIconDivKey}');"
                                                    onmouseout="return showEllipsisIcon('{!approvalReq.request.Id}','{!approvalReq.ellipsisIconParentDivKey}','{!approvalReq.ellipsisIconDivKey}','{!approvalReq.actionIconDivKey}');">
                                                    <div id="{!approvalReq.ellipsisIconDivKey}">
                                                        <apex:outputPanel rendered="{!approvalReq.hasActions}">
                                                            <apex:image url="{!$Resource.Apttus_Approval__Image_Approver_Action}"
                                                                        title="{!$Label.Apttus_Approval__ApproverActions}"
                                                                        alt="{!$Label.Apttus_Approval__ApproverActions}" />
                                                        </apex:outputPanel>
                                                    </div>
                                                    <div id="{!approvalReq.actionIconDivKey}" style="display:none;">
                                                        <apex:outputPanel rendered="{!approvalReq.hasActions}">
                                                            <apex:commandLink rendered="{!approvalReq.canReassignApprover}"
                                                                                onclick="return showReassignApprover('{!approvalReq.request.Id}');">
                                                                <apex:image url="{!$Resource.Apttus_Approval__Image_Approver_Reassign}"
                                                                            title="{!$Label.Apttus_Approval__ReassignApprover}"
                                                                            alt="{!$Label.Apttus_Approval__ReassignApprover}" />
                                                            </apex:commandLink>
                                                            <apex:commandLink rendered="{!approvalReq.canAddApprover}"
                                                                                onclick="return showAddApprover('{!approvalReq.request.Id}');">
                                                                <apex:image url="{!$Resource.Apttus_Approval__Image_Approver_Add}"
                                                                            title="{!$Label.Apttus_Approval__AddApprover}"
                                                                            alt="{!$Label.Apttus_Approval__AddApprover}" />
                                                            </apex:commandLink>
                                                            <apex:commandLink rendered="{!approvalReq.canRemoveApprover}"
                                                                                onclick="return showRemoveApprover('{!approvalReq.request.Id}');">
                                                                <apex:image url="{!$Resource.Apttus_Approval__Image_Approver_Remove}"
                                                                            title="{!$Label.Apttus_Approval__RemoveApprover}"
                                                                            alt="{!$Label.Apttus_Approval__RemoveApprover}" />
                                                            </apex:commandLink>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </apex:column>
                                            <apex:column width="5%" value="{!approvalReq.request.Apttus_Approval__StepSequence__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" />
                                            <apex:column width="5%" value="{!approvalReq.request.Apttus_Approval__Sequence__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" />
                                            <apex:column width="10%"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" >
                                                <apex:facet name="header">
                                                    <apex:outputText value="{!$Label.Apttus_Approval__Status}"></apex:outputText>
                                                </apex:facet>
                                                <apex:outputText value="{!approvalReq.request.Apttus_Approval__Approval_Status__c}" 
                                                                    rendered="{!approvalReq.request.Apttus_Approval__Approval_Status__c == 'Approved'}"
                                                                    styleClass="approvalStatusValueGreen" />
                                                <apex:outputText value="{!approvalReq.request.Apttus_Approval__Approval_Status__c}" 
                                                                    rendered="{!approvalReq.request.Apttus_Approval__Approval_Status__c == 'Rejected'}"
                                                                    styleClass="approvalStatusValueRed" />
                                                <apex:outputText value="{!approvalReq.request.Apttus_Approval__Approval_Status__c}" 
                                                                    rendered="{!NOT(approvalReq.request.Approval_Status__c == 'Approved')
                                                                            && NOT(approvalReq.request.Approval_Status__c == 'Rejected')}"
                                                                    style="color:black;" />
                                            </apex:column>
                                            <apex:column width="10%" value="{!approvalReq.request.Apttus_Approval__Assigned_To_Name__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" />
                                            <apex:column width="10%" value="{!approvalReq.request.Apttus_Approval__DelegateApproverNames__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}">
                                                <apex:facet name="header">
                                                    <apex:outputText value="{!$Label.Apttus_Approval__DelegateApprovers}"></apex:outputText>
                                                </apex:facet>
                                            </apex:column>
                                            <apex:column width="20%" value="{!approvalReq.request.Apttus_Approval__Request_Comments__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}" />
                                            <apex:column width="24%" value="{!approvalReq.request.Apttus_Approval__Approver_Comments__c}"
                                                            style="{!if (approvalReq.enableSelect,'background-color:#fef5e3;','color:black')}">
                                                <apex:facet name="header">
                                                    <apex:outputText value="{!$Label.Apttus_Approval__ApprovalHistory}"></apex:outputText>
                                                </apex:facet>
                                            </apex:column>
                                        </apex:pageBlockTable>
                                    </apex:repeat>
                                    <apex:pageBlockSection id="idComments1" columns="1"
                                                            rendered="{!qrApproval.submitComment1Text != null}">
                                        <apex:outputLabel value="{!$Label[comment1Label]}" style="font-weight:bold;" />
                                        <apex:repeat value="{!qrApproval.submitComment1Lines}" var="cLine">
                                            <apex:outputText value="{!cLine}" style="line-height:1.0;" />
                                        </apex:repeat>
                                    </apex:pageBlockSection>
                                    <apex:pageBlockSection id="idComments2" columns="1"
                                                            rendered="{!qrApproval.submitComment2Text != null}">
                                        <apex:outputLabel value="{!$Label[comment2Label]}" style="font-weight:bold;" />
                                        <apex:repeat value="{!qrApproval.submitComment2Lines}" var="cLine">
                                            <apex:outputText value="{!cLine}" style="line-height:1.0;" />
                                        </apex:repeat>
                                    </apex:pageBlockSection>
                                    <apex:pageBlockSection id="idComments3" columns="1"
                                                            rendered="{!qrApproval.submitComment3Text != null}">
                                        <apex:outputLabel value="{!$Label[comment3Label]}" style="font-weight:bold;" />
                                        <apex:repeat value="{!qrApproval.submitComment3Lines}" var="cLine">
                                            <apex:outputText value="{!cLine}" style="line-height:1.0;" />
                                        </apex:repeat>
                                    </apex:pageBlockSection>
                                </apex:pageBlock>
                            </apex:repeat>
                        </apex:outputPanel>
                    </div>
                </apex:outputPanel>
            </div>

            <apex:outputPanel id="idTakeActionOnEachPanel">
                <apex:outputPanel rendered="{!doTakeActionOnEach}">
                    <script type="text/javascript">
                        // init
                        initCall();
                        
                        // get approval requests
                        var approvalRequestList = new Array();
                        // get request action parameters
                        //var reqActionParams = "{requestActionParams}";
                    </script>   
                    
                    <apex:repeat value="{!allApprovalsTabSelectedReqIds}" var="selectedRequestId" rendered="{!isAllApprovalsTabSelected}">
                        <script type="text/javascript">
                            var approvalRequest = new Object();
                            approvalRequest.id = "{!selectedRequestId}";
                            
                            approvalRequestList.push(approvalRequest);
                        </script>   
                    </apex:repeat>
                    
                    <apex:repeat value="{!selectedReqIds}" var="selectedRequestId" rendered="{!NOT(isAllApprovalsTabSelected)}">
                        <script type="text/javascript">
                            var approvalRequest = new Object();
                            approvalRequest.id = "{!selectedRequestId}";
                            
                            approvalRequestList.push(approvalRequest);
                        </script>   
                    </apex:repeat>
                    
                    <script type="text/javascript">
                        if (approvalRequestList.length > 0) {
                        
                            // display progress window
                            onActionClick();
                                
                            // delay to allow the progress bar to be shown
                            setTimeout(function() {
                                try {
                                    // get count
                                    var currentId = "";
                                    var count = approvalRequestList.length;
                                    // get action type
                                    var isActionTypeApprove = "{!isActionTypeApprove}";
                                    var isActionTypeReject = "{!isActionTypeReject}";
                                    var isActionTypeAddComments = "{!isActionTypeAddComments}";

                                    // invoke action for each
                                    for (var i = 0; i < count; i++) {
                                        currentId = approvalRequestList[i].id;
                                        
                                        // take action on the request
                                        if (isActionTypeApprove == 'true') {
                                            var result = approveRequest(currentId,'{!JSENCODE(approvalComments)}');
                                        
                                        } else if (isActionTypeReject == 'true') {
                                            var result = rejectRequest(currentId,'{!JSENCODE(approvalComments)}');
                                        
                                        } else if (isActionTypeAddComments == 'true') {
                                            var result = addCommentsToRequest(currentId,'{!JSENCODE(approvalComments)}');
                                        
                                        }

                                    }
                                    
                                    // done taking action on all approval requests
                                    invokeDoTakeActionOnEachDone('');
                                    
                                } catch(ex) {
                                    var hasErrors = (ex.errors != null);
                                    var hasFault = (ex.faultcode != null);
                                    
                                    if (hasErrors) {
                                        invokeDoTakeActionOnEachDone(ex.errors.message);
                                    
                                    } else if (hasFault) {
                                        invokeDoTakeActionOnEachDone(ex.faultstring);
                                        
                                    } else {
                                        invokeDoTakeActionOnEachDone(ex.message);
                                    }
                                    
                                } finally {
                                    // hide the progress window
                                    onActionComplete();
                            
                                }
                                
                            }, 500);
                        }
                    </script>   
                    
                </apex:outputPanel>
            </apex:outputPanel>

            <apex:outputPanel >
                <script type="text/javascript">
                    /**
                     * Callback when the add approver action is completed
                     */
                    function onAddApproverComplete() {
                    
                        // hide spinner
                        hideSpinner();
                        
                        // close the add approver dialog
                        if (!{!hasDialogErrors}) {
                            closeAddApprover();
                        }
                        
                        return true;
            
                    }

                    /**
                     * Callback when the remove approver action is completed
                     */
                    function onRemoveApproverComplete() {
                    
                        // hide spinner
                        hideSpinner();
                        
                        // close the remove approver dialog
                        if (!{!hasDialogErrors}) {
                            closeRemoveApprover();
                        }
                        
                        return true;
            
                    }

                    /**
                     * Callback when the reassign approver action is completed
                     */
                    function onReassignApproverComplete() {
                    
                        // hide spinner
                        hideSpinner();
                        
                        // close the reassign approver dialog
                        if (!{!hasDialogErrors}) {
                            closeReassignApprover();
                        }
                        
                        return true;
                    }

                    /**
                     * function to make queueApprovalsTab active
                     */
                    function makeTabActive(){
                        j$(".gpSessionTabItem").removeClass("slds-is-active");
                        j$("#queueApprovalsTab__item").parent().addClass("slds-is-active");
                    }
                    
                </script>
            </apex:outputPanel>

        </apex:outputPanel>

        <!-- actions specific to classic page -->
        <apex:actionFunction name="launchMyApprovals"
                            action="{!doLaunchMyApprovals}"
                            reRender="idPagePanel">
            <apex:param name="param1" assignTo="{!inClassicMode}" value="" />
            <apex:param name="param2" assignTo="{!inLightningMode}" value="" />
            <apex:param name="param3" assignTo="{!inSf1Mode}" value="" />
        </apex:actionFunction>
        <apex:actionFunction name="loadApprovals"
                            action="{!doLoadApprovals}"
                            reRender="idPagePanel">
        </apex:actionFunction>

        <!-- actions common to classic and lightning pages -->
        <!-- don't move these into MyApprovalsActionsInclude or all requests get approved instead of selected ones -->
        <apex:actionFunction name="invokeDoSelectTab" 
                            action="{!doSelectTab}"
                            reRender="idPagePanelApproveRejectActions,idHeaderPanelButtons,idTabPanelContent"
                            status="idPleaseWaitStatus">
            <apex:param name="tabName" value="" />
        </apex:actionFunction>
        <apex:actionFunction name="invokeDoDone"
                            action="{!doDone}"
                            reRender="idDoDonePanel"
                            status="idPleaseWaitStatus">
            <apex:param name="param1" assignTo="{!inClassicMode}" value="" />
            <apex:param name="param2" assignTo="{!inLightningMode}" value="" />
            <apex:param name="param3" assignTo="{!inSf1Mode}" value="" />
        </apex:actionFunction>
        <apex:actionFunction name="invokeDoTakeOwnership" 
                            action="{!doTakeOwnership}" 
                            reRender="idPagePanel"
                            status="idPleaseWaitStatus" oncomplete="makeTabActive();" >
        </apex:actionFunction>
        <apex:actionFunction name="invokeDoApproveAsync" 
                            action="{!doApprove}"
                            reRender="idPagePanel">
            <apex:param name="comment" value="" />
        </apex:actionFunction>
        <apex:actionFunction name="invokeDoRejectAsync" 
                            action="{!doReject}" 
                            reRender="idPagePanel">
            <apex:param name="comment" value="" />
        </apex:actionFunction>
        <!-- including idTabPanel on rerender below grays out the whole tab area while approving -->
        <apex:actionFunction name="invokeDoApproveSync" 
                            action="{!doApprove}"
                            reRender="idTakeActionOnEachPanel">
            <apex:param name="comment" value="" />
        </apex:actionFunction>
        <apex:actionFunction name="invokeDoRejectSync" 
                            action="{!doReject}" 
                            reRender="idTakeActionOnEachPanel">
            <apex:param name="comment" value="" />
        </apex:actionFunction>
        <apex:actionFunction name="invokeDoAddComments" 
                            action="{!doAddComments}" 
                            reRender="idTakeActionOnEachPanel">
            <apex:param name="comment" value="" />
        </apex:actionFunction>
        <apex:actionFunction name="invokeDoTakeActionOnEachDone" 
                            action="{!doTakeActionOnEachDone}"
                            reRender="idPagePanel">
            <apex:param name="errMsg" value="" />
        </apex:actionFunction>
        <apex:actionFunction name="invokeDoSelect" 
                            action="{!doSelect}"
                            reRender="idPagePanelApproveRejectActions,idAllApprovalsTabSelectAllPanel,idMyApprovalsTabSelectAllPanel,idQueueApprovalsTabSelectAllPanel"
                            status="idPleaseWaitStatus">
            <apex:param name="requestId" value="" />  
        </apex:actionFunction>
        <apex:actionFunction name="invokeDoSelectAll" 
                            action="{!doSelectAll}"
                            reRender="idTabPanelContent"
                            status="idPleaseWaitStatus">
        </apex:actionFunction>
        
        <apex:actionStatus id="idPleaseWaitStatus"
                        onstart="onActionClick();"
                        onstop="onActionComplete();" />

        <!-- actions common to classic and lightning pages -->
        <apex:actionFunction name="invokeShowAddApprover"
                            action="{!doShowAddApprover}"
                            reRender="idAddApproverContentPanel"
                            onComplete="onShowAddApproverComplete();">  
            <apex:param name="requestId" value="" />  
        </apex:actionFunction>
        <apex:actionFunction name="invokeShowRemoveApprover"
                            action="{!doShowRemoveApprover}"
                            onComplete="onShowRemoveApproverComplete();">  
            <apex:param name="requestId" value="" />  
        </apex:actionFunction>
        <apex:actionFunction name="invokeSearchAddApprover"
                            action="{!doSearchAddApprover}"
                            reRender="idAddApproverSearchPanel"
                            onComplete="onSearchAddApproverComplete();">  
            <apex:param name="requestId" value="" />  
            <apex:param name="assigneeType" value="" />  
            <apex:param name="searchText" value="" />  
        </apex:actionFunction>
        <apex:actionFunction name="invokeDoAddApprover"
                            action="{!doAddApprover}"
                            reRender="idPagePanel,idAddApproverContentPanel"
                            onComplete="onAddApproverComplete();"
                            status="idPleaseWaitStatus">  
            <apex:param name="requestId" value="" />  
            <apex:param name="mode" value="" />  
            <apex:param name="stepLabel" value="" />  
            <apex:param name="assigneeType" value="" />  
            <apex:param name="assigneeName" value="" />  
            <apex:param name="assigneeId" value="" />  
            <apex:param name="comment" value="" />
        </apex:actionFunction>
        <apex:actionFunction name="invokeDoCancelAddApprover" 
                            action="{!doCancelAddApprover}" 
                            reRender="idPagePanel"
                            onComplete="onAddApproverComplete();">
        </apex:actionFunction>
        <apex:actionFunction name="invokeDoRemoveApprover"
                            action="{!doRemoveApprover}"
                            reRender="idPagePanel"
                            onComplete="onRemoveApproverComplete();">  
            <apex:param name="requestId" value="" />  
        </apex:actionFunction>
        <apex:actionFunction name="invokeShowReassignApprover"
                            action="{!doShowReassignApprover}"
                            reRender="idReassignApproverContentPanel"
                            onComplete="onShowReassignApproverComplete();">  
            <apex:param name="requestId" value="" />  
        </apex:actionFunction>
        <apex:actionFunction name="invokeSearchReassignApprover"
                            action="{!doSearchReassignApprover}"
                            reRender="idReassignApproverSearchPanel"
                            onComplete="onSearchReassignApproverComplete();">
            <apex:param name="requestId" value="" />  
            <apex:param name="searchText" value="" />  
        </apex:actionFunction>
        <apex:actionFunction name="invokeDoReassignApprover"
                            action="{!doReassignApprover}"
                            reRender="idPagePanel,idReassignApproverContentPanel"
                            onComplete="onReassignApproverComplete();">  
            <apex:param name="requestId" value="" />  
            <apex:param name="assigneeType" value="" />  
            <apex:param name="assigneeName" value="" />  
            <apex:param name="assigneeId" value="" />  
            <apex:param name="comment" value="" />
        </apex:actionFunction>
        <apex:actionFunction name="invokeDoCancelReassignApprover" 
                            action="{!doCancelReassignApprover}" 
                            reRender="idPagePanel"
                            onComplete="onReassignApproverComplete();">
        </apex:actionFunction>
    </apex:form>

    <div id="idSpinnerPanel" style="height:6rem;display:none">
        <div class="slds-spinner_container">
            <div role="status" class="slds-spinner slds-spinner_medium slds-spinner_brand">
                <span class="slds-assistive-text">Loading</span>
                <div class="slds-spinner__dot-a"></div>
                <div class="slds-spinner__dot-b"></div>
            </div>
        </div>
    </div>

    <!-- dialog to enter comments when approving request(s) -->
    <div id="idApprovePanel" style="display:none">
        <section id="idApproveDialogSection" role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1">
            <div class="slds-modal__container">
                <apex:form id="idApproveForm">
                    <header class="slds-modal__header">
                        <!--<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close">
                            <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#close"></use>
                            </svg>
                            <span class="slds-assistive-text">Close</span>
                        </button>-->
                        <h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate">{!$Label.Apttus_Approval__Approve}</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_small" id="modal-content-id-1">
                        <div class="slds-form-element">
                            <apex:outputLabel value="{!$Label.Apttus_Approval__AddCommentRequired}" for="idApproveComment" rendered="{!isApprovalCommentsMandatory}" styleClass="slds-form-element__label" />
                            <apex:outputLabel value="{!$Label.Apttus_Approval__AddCommentOptional}" for="idApproveComment" rendered="{!NOT(isApprovalCommentsMandatory)}" styleClass="slds-form-element__label" />
                            <div class="slds-form-element__control">
                                <apex:inputTextArea id="idApproveComment" value="{!approvalComments}" styleClass="slds-textarea" />
                            </div>
                        </div>
                    </div>
                    <footer class="slds-modal__footer">
                        <apex:commandButton value="{!$Label.Apttus_Approval__Save}"
                                            onclick="onActionClickApprove(); return false;" 
                                            styleClass="slds-button slds-button_brand" />
                        <apex:commandButton value="{!$Label.Apttus_Approval__Cancel}" 
                                            onclick="hideApprove(); return false;"
                                            styleClass="slds-button slds-button_neutral" />
                    </footer>
                </apex:form>
            </div>
        </section>
        <div id="idApproveDialogBackdrop" class="slds-backdrop" />
    </div>

    <!-- dialog to enter comments when rejecting request(s) -->
    <div id="idRejectPanel" style="display:none">
        <section id="idRejectDialogSection" role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open" aria-labelledby="modal-heading-02" aria-modal="true" aria-describedby="modal-content-id-2">
            <div class="slds-modal__container">
                <apex:form id="idRejectForm">
                    <header class="slds-modal__header">
                        <!--<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close">
                            <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#close"></use>
                            </svg>
                            <span class="slds-assistive-text">Close</span>
                        </button>-->
                        <h2 id="modal-heading-02" class="slds-modal__title slds-hyphenate">{!$Label.Apttus_Approval__Reject}</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_small" id="modal-content-id-2">
                        <div class="slds-form-element">
                            <apex:outputLabel value="{!$Label.Apttus_Approval__AddCommentRequired}" for="idRejectComment" rendered="{!isApprovalCommentsMandatory}" styleClass="slds-form-element__label" />
                            <apex:outputLabel value="{!$Label.Apttus_Approval__AddCommentOptional}" for="idRejectComment" rendered="{!NOT(isApprovalCommentsMandatory)}" styleClass="slds-form-element__label" />
                            <div class="slds-form-element__control">
                                <apex:inputTextArea id="idRejectComment" value="{!approvalComments}" styleClass="slds-textarea" />
                            </div>
                        </div>
                    </div>
                    <footer class="slds-modal__footer">
                        <apex:commandButton value="{!$Label.Apttus_Approval__Save}"
                                            onclick="onActionClickReject(); return false;" 
                                            styleClass="slds-button slds-button_brand" />
                        <apex:commandButton value="{!$Label.Apttus_Approval__Cancel}" 
                                            onclick="hideReject(); return false;"
                                            styleClass="slds-button slds-button_neutral" />
                    </footer>
                </apex:form>
            </div>
        </section>
        <div id="idRejectDialogBackdrop" class="slds-backdrop" />
    </div>

    <!-- dialog to enter comments when saving comments to request(s) -->
    <div id="idSaveCommentPanel" style="display:none">
        <section id="idSaveCommentDialogSection" role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open" aria-labelledby="modal-heading-03" aria-modal="true" aria-describedby="modal-content-id-3">
            <div class="slds-modal__container">
                <apex:form id="idSaveCommentForm">
                    <header class="slds-modal__header">
                        <!--<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close">
                            <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#close"></use>
                            </svg>
                            <span class="slds-assistive-text">Close</span>
                        </button>-->
                        <h2 id="modal-heading-03" class="slds-modal__title slds-hyphenate">{!$Label.Apttus_Approval__SaveComment}</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_small" id="modal-content-id-3">
                        <div class="slds-form-element">
                            <apex:outputLabel value="{!$Label.Apttus_Approval__AddCommentRequired}" for="idAddComment" rendered="{!isApprovalCommentsMandatory}" styleClass="slds-form-element__label" />
                            <apex:outputLabel value="{!$Label.Apttus_Approval__AddCommentOptional}" for="idAddComment" rendered="{!NOT(isApprovalCommentsMandatory)}" styleClass="slds-form-element__label" />
                            <div class="slds-form-element__control">
                                <apex:inputTextArea id="idAddComment" value="{!approvalComments}" styleClass="slds-textarea" />
                            </div>
                        </div>
                    </div>
                    <footer class="slds-modal__footer">
                        <apex:commandButton value="{!$Label.Apttus_Approval__Save}"
                                            onclick="onActionClickAddComment(); return false;" 
                                            styleClass="slds-button slds-button_brand" />
                        <apex:commandButton value="{!$Label.Apttus_Approval__Cancel}" 
                                            onclick="hideAddComment(); return false;"
                                            styleClass="slds-button slds-button_neutral" />
                    </footer>
                </apex:form>
            </div>
        </section>
        <div id="idSaveCommentDialogBackdrop" class="slds-backdrop" />
    </div>

    <!-- dialog to add approvers -->
    <div id="idAddApproverPanel" style="display:none">
        <section id="idAddApproverDialogSection" role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open" aria-labelledby="modal-heading-04" aria-modal="true" aria-describedby="modal-content-id-4">
            <div class="slds-modal__container">
                <apex:form id="idAddApproverForm">
                    <header class="slds-modal__header">
                        <!--<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close">
                            <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#close"></use>
                            </svg>
                            <span class="slds-assistive-text">Close</span>
                        </button>-->
                        <h2 id="modal-heading-04" class="slds-modal__title slds-hyphenate">{!$Label.Apttus_Approval__AddApprover}</h2>
                    </header>
                    <apex:outputPanel id="idAddApproverContentPanel">
                        <div class="slds-modal__content slds-p-around_small" id="modal-content-id-4">
                            <div class="slds-form-element">
                                <div class="slds-text-body_regular" rendered="{!hasDialogErrors}">
                                    <apex:pageMessages />
                                </div>
                            </div>
                            <div class="slds-form-element">
                                <div id="idErrorText" class="slds-text-body_regular validateTips">
                                    Specify information about the approver you are adding for the selected request:
                                </div>
                            </div>
                            <div class="slds-form-element">
                                <apex:inputText id="idAddApproverRequestId" value="{!requestId}" styleClass="slds-input" style="display:none;" />
                                <script>
                                    fldRequestId = j$("[id*=idAddApproverRequestId]");
                                </script>
                            </div>
                            <div class="slds-form-element">
                                <label class="slds-form-element__label" for="idAddApproverMode">
                                    <abbr class="slds-required" title="required">* </abbr>Select a sequence
                                </label>
                                <div class="slds-form-element__control">
                                    <div class="slds-select_container">
                                        <apex:selectList id="idAddApproverMode" value="{!mode}" styleClass="slds-select" size="1">
                                            <apex:selectOptions value="{!addApproverModes}" />
                                        </apex:selectList>
                                    </div>
                                </div>
                                <script>
                                    fldMode = j$("[id*=idAddApproverMode]");
                                </script>
                            </div>
                            <div class="slds-form-element">
                                <label class="slds-form-element__label" for="idAddApproverStepLabel">Enter a {!$Label.StepLabel}</label>
                                <div class="slds-form-element__control">
                                    <apex:inputText id="idAddApproverStepLabel" value="{!stepLabel}" styleClass="slds-input" />
                                </div>
                                <script>
                                    fldStepLabel = j$("[id*=idAddApproverStepLabel]");
                                </script>
                            </div>
                            <div class="slds-form-element">
                                <label class="slds-form-element__label" for="idAddApproverAssigneeType">
                                    <abbr class="slds-required" title="required">* </abbr>Select an approver type
                                </label>
                                <div class="slds-form-element__control">
                                    <apex:actionStatus id="idStatusWaitAssigneeType">
                                        <apex:facet name="start">
                                            <img src="/apexpages/devmode/img/saveStatus.gif" />
                                        </apex:facet>
                                        <apex:facet name="stop" />
                                    </apex:actionStatus>
                                    <div class="slds-select_container">
                                        <apex:selectList id="idAddApproverAssigneeType" value="{!assigneeType}" styleClass="slds-select" size="1">
                                            <apex:selectOptions value="{!addApproverAssigneeTypes}" />
                                            <apex:actionSupport event="onchange"
                                                                action="{!doAddApproverAssigneeTypeChanged}"
                                                                reRender="idAddApproverContentPanel"
                                                                status="idStatusWaitAssigneeType" />
                                        </apex:selectList>
                                    </div>
                                </div>
                                <script>
                                    fldAssigneeType = j$("[id*=idAddApproverAssigneeType]");
                                </script>
                            </div>
                            <div class="slds-form-element">
                                <label class="slds-form-element__label">
                                    <abbr class="slds-required" title="required">* </abbr>Select an approver
                                </label>
                                <apex:actionStatus id="idStatusWaitRelatedUser">
                                    <apex:facet name="start">
                                        <img src="/apexpages/devmode/img/saveStatus.gif" />
                                    </apex:facet>
                                    <apex:facet name="stop" />
                                </apex:actionStatus>
                                <apex:outputPanel rendered="{!NOT(IsAddApproverAssigneeTypeRelatedUser)}">
                                    <apex:inputText id="idAddApproverAssigneeName" value="{!assigneeName}" styleClass="slds-input" onchange="return onChangeAddApproverAssigneeName();" />
                                    <apex:commandButton id="idSearchApproverBtn"
                                                        value="{!$Label.Apttus_Approval__Search}"
                                                        onclick="return showAddApproverSearch();"
                                                        styleClass="slds-button slds-button_neutral">
                                        <!--<span class="slds-icon_container slds-icon-utility-search" title="Search">
                                            <svg class="slds-icon slds-icon-text-default" aria-hidden="true">
                                                <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#search"></use>
                                            </svg>
                                            <span class="slds-assistive-text">Search</span>
                                        </span>-->
                                </apex:commandButton>
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsAddApproverAssigneeTypeRelatedUser}">
                                    <div class="slds-select_container">
                                        <apex:selectList id="idAddApproverAssigneeNameRelatedUser" value="{!assigneeName}" styleClass="slds-select" size="1">
                                            <apex:selectOptions value="{!addApproverRelatedUsers}" />
                                            <apex:actionSupport event="onchange"
                                                                action="{!doRelatedUserChanged}"
                                                                reRender="idAddApproverContentPanel"
                                                                status="idStatusWaitRelatedUser" />
                                        </apex:selectList>
                                    </div>
                                </apex:outputPanel>
                                <script>
                                    fldAssigneeName = j$("[id*=idAddApproverAssigneeName]");
                                </script>
                            </div>
                            <div class="slds-form-element">
                                <apex:inputText id="idAddApproverAssigneeId" value="{!assigneeId}" styleClass="slds-input" style="display:none;" />
                                <script>
                                    fldAssigneeId = j$("[id*=idAddApproverAssigneeId]");
                                </script>
                            </div>
                            <div class="slds-form-element">
                                <label class="slds-form-element__label" for="idAddApproverComment">{!$Label.Apttus_Approval__AddCommentOptional}</label>
                                <div class="slds-form-element__control">
                                    <apex:inputTextArea id="idAddApproverComment" value="{!comment}" styleClass="slds-textarea" />
                                </div>
                                <script>
                                    fldComment = j$("[id*=idAddApproverComment]");
                                </script>
                            </div>
                        </div>
                    </apex:outputPanel>
                    <footer class="slds-modal__footer">
                        <apex:commandButton value="{!$Label.Apttus_Approval__Save}"
                                            onclick="onActionSaveAddApprover(); return false;"
                                            reRender="idAddApproverContentPanel"
                                            styleClass="slds-button slds-button_brand" />
                        <apex:commandButton value="{!$Label.Apttus_Approval__Cancel}" 
                                            onclick="onActionCancelAddApprover(); return false;"
                                            styleClass="slds-button slds-button_neutral" />
                    </footer>
                </apex:form>
            </div>
        </section>
        <div id="idAddApproverDialogBackdrop" class="slds-backdrop" />
    </div>

    <!-- dialog to search approvers for add approver action -->
    <div id="idAddApproverSearchPanel" style="display:none">
        <section id="idAddApproverSearchDialogSection" role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open" aria-labelledby="modal-heading-05" aria-modal="true" aria-describedby="modal-content-id-5">
            <div class="slds-modal__container">
                <apex:form id="idAddApproverSearchForm">
                    <header class="slds-modal__header">
                        <!--<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close">
                            <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#close"></use>
                            </svg>
                            <span class="slds-assistive-text">Close</span>
                        </button>-->
                        <h2 id="modal-heading-05" class="slds-modal__title slds-hyphenate">{!$Label.Apttus_Approval__AddApprover} Search</h2>
                    </header>
                    <apex:outputPanel id="idAddApproverSearchPanel">
                        <div class="slds-modal__content slds-p-around_small" id="modal-content-id-5">
                            <div class="slds-form-element">
                                <apex:outputPanel rendered="{!IsActionModeAddApprover && IsAddApproverAssigneeTypeUser && isCommunitiesUser}">
                                    <c:UIDataTable cContainerIdAttr="idAddApproverUserTable"
                                                sObjectTypeAttr="User"
                                                columnFieldsAttr="Name,Email"
                                                columnTitlesAttr="Name,Email"
                                                modeAttr="add"
                                                searchTextAttr="{!searchText}"
                                                requestAttr="{!request}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsActionModeAddApprover && IsAddApproverAssigneeTypeUser && NOT(isCommunitiesUser)}">
                                    <c:UIDataTable cContainerIdAttr="idAddApproverUserTable"
                                                sObjectTypeAttr="User"
                                                columnFieldsAttr="Name,Email,UserRole.Name"
                                                columnTitlesAttr="Name,Email,Role"
                                                modeAttr="add"
                                                searchTextAttr="{!searchText}"
                                                requestAttr="{!request}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsActionModeAddApprover && IsAddApproverAssigneeTypeQueue}">
                                    <c:UIDataTable cContainerIdAttr="idAddApproverQueueTable"
                                                sObjectTypeAttr="QueueSobject"
                                                columnFieldsAttr="Queue.Name,Queue.DeveloperName,Queue.Email"
                                                columnTitlesAttr="Label,Name,Email"
                                                modeAttr="add"
                                                searchTextAttr="{!searchText}"
                                                requestAttr="{!request}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsActionModeAddApprover && IsAddApproverAssigneeTypeRole}">
                                    <c:UIDataTable cContainerIdAttr="idAddApproverRoleTable"
                                                sObjectTypeAttr="UserRole"
                                                columnFieldsAttr="Name,RollupDescription"
                                                columnTitlesAttr="Name,Role Description"
                                                modeAttr="add"
                                                searchTextAttr="{!searchText}"
                                                requestAttr="{!request}" />
                                </apex:outputPanel>
                            </div>
                        </div>
                    </apex:outputPanel>
                    <footer class="slds-modal__footer">
                        <apex:commandButton value="{!$Label.Apttus_Approval__Cancel}"
                                            onclick="hideAddApproverSearchDialog(); return false;" 
                                            styleClass="slds-button slds-button_brand" />
                    </footer>
                </apex:form>
            </div>
        </section>
        <div id="idAddApproverSearchDialogBackdrop" class="slds-backdrop" />
    </div>

    <!-- dialog to remove approver -->
    <div id="idRemoveApproverPanel" style="display:none">
        <section id="idRemoveApproverDialogSection" role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open" aria-labelledby="modal-heading-06" aria-modal="true" aria-describedby="modal-content-id-6">
            <div class="slds-modal__container">
                <apex:form id="idRemoveApproverForm">
                    <header class="slds-modal__header">
                        <!--<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close">
                            <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#close"></use>
                            </svg>
                            <span class="slds-assistive-text">Close</span>
                        </button>-->
                        <h2 id="modal-heading-06" class="slds-modal__title slds-hyphenate">{!$Label.Apttus_Approval__RemoveApprover}</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_small" id="modal-content-id-6">
                        <div class="slds-form-element">
                            <div class="slds-form-element">
                                <apex:inputText id="idRemoveApproverRequestId" value="{!requestId}" styleClass="slds-input" style="display:none;" />
                                <script>
                                    fldRequestId = j$("[id*=idRemoveApproverRequestId]");
                                </script>
                            </div>
                        </div>
                        <div class="slds-form-element">
                            <label class="slds-form-element__label">{!$Label.DeleteConfirmationMessage}</label>
                        </div>
                    </div>
                    <footer class="slds-modal__footer">
                        <apex:commandButton value="{!$Label.Apttus_Approval__Confirm}"
                                            onclick="onActionConfirmRemoveApprover(); return false;" 
                                            styleClass="slds-button slds-button_brand" />
                        <apex:commandButton value="{!$Label.Apttus_Approval__Cancel}" 
                                            onclick="onActionCancelRemoveApprover(); return false;"
                                            styleClass="slds-button slds-button_neutral" />
                    </footer>
                </apex:form>
            </div>
        </section>
        <div id="idRemoveApproverDialogBackdrop" class="slds-backdrop" />
    </div>

    <!-- dialog to reassign approvers -->
    <div id="idReassignApproverPanel" style="display:none">
        <section id="idReassignApproverDialogSection" role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open" aria-labelledby="modal-heading-07" aria-modal="true" aria-describedby="modal-content-id-7">
            <div class="slds-modal__container">
                <apex:form id="idReassignApproverForm">
                    <header class="slds-modal__header">
                        <!--<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close">
                            <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#close"></use>
                            </svg>
                            <span class="slds-assistive-text">Close</span>
                        </button>-->
                        <h2 id="modal-heading-07" class="slds-modal__title slds-hyphenate">{!$Label.Apttus_Approval__ReassignApprover}</h2>
                    </header>
                    <apex:outputPanel id="idReassignApproverContentPanel">
                        <div class="slds-modal__content slds-p-around_small" id="modal-content-id-7">
                            <div class="slds-form-element">
                                <div class="slds-text-body_regular" rendered="{!hasDialogErrors}">
                                    <apex:pageMessages />
                                </div>
                            </div>
                            <div class="slds-form-element">
                                <label class="slds-form-element__label">{!request.StepLabel__c} - {!request.Assigned_To_Name__c}</label>
                            </div>
                            <div class="slds-form-element">	
                                <apex:inputText id="idReassignApproverRequestId" value="{!requestId}" styleClass="slds-input" style="display:none;" />
                                <script>
                                    fldRequestId = j$("[id*=idReassignApproverRequestId]");
                                </script>
                            </div>
                            <div class="slds-form-element">
                                <label class="slds-form-element__label" for="idReassignApproverMode">
                                    <abbr class="slds-required" title="required">* </abbr>Select an approver type
                                </label>
                                <div class="slds-form-element__control">
                                    <apex:actionStatus id="idStatusWaitAssigneeType">
                                        <apex:facet name="start">
                                            <img src="/apexpages/devmode/img/saveStatus.gif" />
                                        </apex:facet>
                                        <apex:facet name="stop" />
                                    </apex:actionStatus>
                                    <div class="slds-select_container">
                                        <apex:selectList id="idReassignApproverAssigneeType" value="{!assigneeType}" styleClass="slds-select" size="1">
                                            <apex:selectOptions value="{!reassignApproverAssigneeTypes}" />
                                            <apex:actionSupport event="onchange"
                                                                action="{!doReassignApproverAssigneeTypeChanged}"
                                                                reRender="idReassignApproverContentPanel"
                                                                status="idStatusWaitAssigneeType" />
                                        </apex:selectList>
                                    </div>
                                </div>
                                <script>
                                    fldAssigneeType = j$("[id*=idReassignApproverAssigneeType]");
                                </script>
                            </div>
                            <div class="slds-form-element">
                                <label class="slds-form-element__label">
                                    <abbr class="slds-required" title="required">* </abbr>Select an approver
                                </label>
                                <apex:inputText id="idReassignApproverAssigneeName"
                                                value="{!assigneeName}"
                                                styleClass="slds-input" 
                                                onchange="return onChangeReassignApproverAssigneeName();" />
                                <apex:commandButton id="idSearchApproverBtn"
                                                    value="{!$Label.Apttus_Approval__Search}"
                                                    onclick="return showReassignApproverSearch();"
                                                    styleClass="slds-button slds-button_neutral" />
                                <script>
                                    fldAssigneeName = j$("[id*=idReassignApproverAssigneeName]");
                                </script>
                            </div>
                            <div class="slds-form-element">
                                <apex:inputText id="idReassignApproverAssigneeId" value="{!assigneeId}" styleClass="slds-input" style="display:none;" />
                                <script>
                                    fldAssigneeId = j$("[id*=idReassignApproverAssigneeId]");
                                </script>
                            </div>
                            <div class="slds-form-element">
                                <label class="slds-form-element__label" for="idReassignApproverComment">{!$Label.Apttus_Approval__AddCommentOptional}</label>
                                <div class="slds-form-element__control">
                                    <apex:inputTextArea id="idReassignApproverComment" value="{!comment}" styleClass="slds-textarea" />
                                </div>
                                <script>
                                    fldComment = j$("[id*=idReassignApproverComment]");
                                </script>
                            </div>
                        </div>
                    </apex:outputPanel>
                    <footer class="slds-modal__footer">
                        <apex:commandButton value="{!$Label.Apttus_Approval__Save}"
                                            onclick="onActionSaveReassignApprover(); return false;"
                                            reRender="idReassignApproverContentPanel"
                                            styleClass="slds-button slds-button_brand" />
                        <apex:commandButton value="{!$Label.Apttus_Approval__Cancel}" 
                                            onclick="onActionCancelReassignApprover(); return false;"
                                            styleClass="slds-button slds-button_neutral" />
                    </footer>
                </apex:form>
            </div>
        </section>
        <div id="idReassignApproverDialogBackdrop" class="slds-backdrop" />
    </div>

    <!-- dialog to search approvers for reassign action -->
    <div id="idReassignApproverSearchPanel" style="display:none">
        <section id="idReassignApproverSearchDialogSection" role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open" aria-labelledby="modal-heading-08" aria-modal="true" aria-describedby="modal-content-id-8">
            <div class="slds-modal__container">
                <apex:form id="idReassignApproverSearchForm">
                    <header class="slds-modal__header">
                        <!--<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close">
                            <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
                                <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#close"></use>
                            </svg>
                            <span class="slds-assistive-text">Close</span>
                        </button>-->
                        <h2 id="modal-heading-08" class="slds-modal__title slds-hyphenate">{!$Label.Apttus_Approval__ReassignApprover} Search</h2>
                    </header>
                    <apex:outputPanel id="idReassignApproverSearchPanel">
                        <div class="slds-modal__content slds-p-around_small" id="modal-content-id-8">
                            <div class="slds-form-element">
                                <apex:outputPanel rendered="{!IsActionModeReassignApprover && IsReassignApproverAssigneeTypeUser && isCommunitiesUser}">
                                    <c:UIDataTable cContainerIdAttr="idReassignApproverUserTable"
                                                sObjectTypeAttr="User"
                                                columnFieldsAttr="Name,Username"
                                                columnTitlesAttr="Name,Username"
                                                modeAttr="reassign"
                                                searchTextAttr="{!searchText}"
                                                requestAttr="{!request}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsActionModeReassignApprover && IsReassignApproverAssigneeTypeUser && NOT(isCommunitiesUser)}">
                                    <c:UIDataTable cContainerIdAttr="idReassignApproverUserTable"
                                                sObjectTypeAttr="User"
                                                columnFieldsAttr="Name,UserRole.Name,Username"
                                                columnTitlesAttr="Name,Role,Username"
                                                modeAttr="reassign"
                                                searchTextAttr="{!searchText}"
                                                requestAttr="{!request}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsActionModeReassignApprover && IsReassignApproverAssigneeTypeQueue}">
                                    <c:UIDataTable cContainerIdAttr="idReassignApproverQueueTable"
                                                sObjectTypeAttr="QueueSobject"
                                                columnFieldsAttr="Queue.Name,Queue.DeveloperName,Queue.Email"
                                                columnTitlesAttr="Label,Name,Email"
                                                modeAttr="reassign"
                                                searchTextAttr="{!searchText}"
                                                requestAttr="{!request}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsActionModeReassignApprover && IsReassignApproverAssigneeTypeRole}">
                                    <c:UIDataTable cContainerIdAttr="idReassignApproverRoleTable"
                                                sObjectTypeAttr="UserRole"
                                                columnFieldsAttr="Name,RollupDescription"
                                                columnTitlesAttr="Name,Role Description"
                                                modeAttr="reassign"
                                                searchTextAttr="{!searchText}"
                                                requestAttr="{!request}" />
                                </apex:outputPanel>
                            </div>
                        </div>
                    </apex:outputPanel>
                    <footer class="slds-modal__footer">
                        <apex:commandButton value="{!$Label.Apttus_Approval__Cancel}"
                                            onclick="hideReassignApproverSearchDialog(); return false;" 
                                            styleClass="slds-button slds-button_brand" />
                    </footer>
                </apex:form>
            </div>
        </section>
        <div id="idReassignApproverSearchDialogBackdrop" class="slds-backdrop" />
    </div>

    <!-- slds scope -->
    </div>

    </body>
    </html>
</apex:page>